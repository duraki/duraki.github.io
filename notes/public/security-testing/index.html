<!DOCTYPE html>
<html><title>Security Testing</title>


<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
/>
<meta name="apple-mobile-web-app-capable" content="yes" />

<link href="/favicon.png" rel="icon" type="image/x-icon" />


<link rel="stylesheet" href="/notes/public/css/index.db0ff6adb85d12a55dc7afd153794f1bb4b22f39d3efe031d0be4456af877dea.css" />

<style type="text/css">
  :root {
    --color: #333;
    --background-color: #fafafa;
    --line-height: 1.4;
    --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";

    --header-background-color: #ffffff;
    --header-border-bottom-color: #ccc;
    --header-color: #000000;

    --page-background-color: #ffffff;
    --page-border-left-color: rgba(0, 0, 0, 0.05);
    --page-link-color: rgba(10, 132, 255, 1);
    --page-max-width: 625px;
    --page-font-size: 17px;
    --page-line-height: 24px;
    --page-hr-background-color: #dddddd;

    --backlinks-background-color: #fafafc;
    --backlinks-border-radius: 16px;
    --backlink-label-color: #888888;
    --backlink-title-color: #000000;
    --backlink-preview-color: rgb(102, 102, 102);
    --backlink-hover-background-color: rgba(0, 0, 0, 0.05);

    --preview-width: 625px;
    --preview-max-height: 400px;
    --preview-scale: 0.8;
    --preview-box-shadow-top-color: rgba(0, 0, 0, 0.08);
    --preview-box-shadow-right-color: rgba(0, 0, 0, 0.04);
    --preview-box-shadow-bottom-color: rgba(0, 0, 0, 0.15);
    --preview-box-shadow-left-color: rgba(0, 0, 0, 0.04);

    --search-extract-color: #aaaaaa;
  }

 .menu-item-position {
    font-size: 14px;
    display: inline;
    margin: 0 5px 0 0;
}

.menu-item {
    margin: 0 0 10px 0;
    font-weight: bold;
}
.menu-item {
    font-size: 100%;
}

#head {
    margin-left: 15px;
    font-family: "Courier New";
    font: 14px 'Courier New';
     
}

#wrap {
    width: 550px;
    margin: 10px;
}

body {
    background: #fff;
     
}

.title-coded {
    font-size: 12px;
}
</style>


<body><header>
    <a href="/notes/public/" id="logo-and-title">
    
    <div class="site-logo">
       <img class="site-logo" src="/notes/public/favicon.png" />
    </div>
        </a>

        <div id="head">
            <h1 class="menu-item menu-item-position"><a class="author">duraki&#39;s notes</a></h1> / 
            <h1 class="menu-item menu-item-position"> <a class="author" href="/about.html">halis duraki</a></h1> /
            <h1 class="menu-item menu-item-position"><a class="author" href="/reports.html">security rep+</a></h1> / 
            <h1 class="menu-item menu-item-position"><a class="author" href="/consulting/">consulting</a></h1> / 
            <h1 class="menu-item menu-item-position"><a class="author" href="/">blog</a> </h1>
        </div><form id="search"
    action='http://127.0.0.1:8800/notes/public/search/' method="get">
    <label hidden for="search-input">Search site</label>
    <input type="text" id="search-input" name="query"
    placeholder="Type here to search">
    <input type="submit" value="search">
</form>
</header>

<div class="grid-container">
  <div class="grid">
    <div class="page" data-level="1">
      <div class="content">
        <h1>Security Testing</h1>
        <h2 id="security-testing-methods">Security Testing Methods</h2>
<ul>
<li>Brute-force CAN fuzzer for fuzzing application software</li>
<li>Interface scanner, layered fuzzing</li>
<li>DoS, Replay Messages, Tampering</li>
<li>Man in the Middle</li>
<li>Read and write into flash dump (extract keys, certificates, sensitive data)</li>
</ul>
<h2 id="security-testing-in-practice">Security Testing in Practice</h2>
<ul>
<li>Send out particular frame IDs using IG Generator</li>
<li>Mount network-based attacks like DoS, MiTM, Tampering of Signals</li>
<li>Access to debug ports like JTAG to extract + corrupt flash memory/firmware</li>
<li>Flash dump - Look into sensitive data</li>
</ul>
<h3 id="approach">Approach</h3>
<ul>
<li>Reconnaissance</li>
<li>Start with market requirements</li>
<li>Use customer-provided documents of the system, brochures, user manuals, published material and attacks and vulnerabilities of used components</li>
</ul>
<h3 id="understand-the-architecture">Understand the Architecture</h3>
<ul>
<li>Analyze high-level architecture and interfaces to understand interaction between different components</li>
<li>Use architecture model, system context, interface model, attack pathway, sequence diagram</li>
</ul>
<h3 id="identify-valued-and-protectable-assets">Identify valued and protectable assets</h3>
<ul>
<li>Identify relevant assets, such is hardware, software, database, etc.</li>
<li>Parse every requirement (requirement description) for a specific asset
- Splut it into SFOP scheme (Safety, Finance, Operational Performance, Privacy)</li>
</ul>
<h3 id="generate-penetration-test-cases">Generate Penetration Test Cases</h3>
<ul>
<li>Do X and Y on CAN</li>
<li>Do Z and W on LIN</li>
</ul>
<h3 id="perform-risk-based-greybox-pt">Perform risk-based greybox PT</h3>
<ul>
<li>
<p>Re-create attack scenarios on devices to identify potential vulns</p>
</li>
<li>
<p>Injecting,tampering</p>
<ul>
<li>Software checks:
<ul>
<li>Invalid address</li>
<li>Modified SW</li>
<li>Odd address</li>
<li>Invalid signature</li>
<li>Invalid seed-key</li>
<li>Downgrade software</li>
<li>Secure boot?</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="ques">Ques?</h2>
<ul>
<li>Can we read the key, flash?</li>
<li>Can we modify the flash or CAN messages?</li>
<li>Can we perform a DoS and make the service unavailable</li>
<li>Whats the goal of the attacker? What can he misuse and abuse</li>
</ul>

      </div>
      



   

   

   

   

   

   

   

   

   

   

   

   

   




      </div>
   </div>
</div>

<script src="http://127.0.0.1:8800/notes/public/js/URI.js" type="text/javascript"></script>

<script src="http://127.0.0.1:8800/notes/public/js/page.js" type="text/javascript"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
window.store = {
    
    
    
    
    "http:\/\/127.0.0.1:8800\/notes\/public\/": {
        
        "title": "Index",
        "tags": [],
        "content": "Hello, these are my personal notes and knowledge graph. I started using Obsidian a bit early in 2020. and continued graphing my knowledge from there.\nI wanted something more towards functional, as to offer me a practical snippet library for my TTP\u0026rsquo;s, both online and as a backup of dementia.\nThe notes are largery inspired by others and especial Andy\u0026rsquo;s note-taking samples on his site. Thanks to Justin and Jethro for their theme support on static generation for this library of mine. Hope it will be worth to you as well as me.\nYou can start exploring from the List of Topics, List of Tools, or see the full list of notes.\n How it works Additionalities offered through [params.styles] via config.toml. It\u0026rsquo;s possible to deploy dark version as well. Read for more in *.css.\n", 
        "url": "http:\/\/127.0.0.1:8800\/notes\/public\/"
    },
    
    
    
    "http:\/\/127.0.0.1:8800\/notes\/public\/search\/": {
        
        "title": "Search",
        "tags": [],
        "content": "", 
        "url": "http:\/\/127.0.0.1:8800\/notes\/public\/search\/"
    },
    
    
    
    "http:\/\/127.0.0.1:8800\/notes\/public\/": {
        
        "title": "",
        "tags": [],
        "content": "Calibration  ECU tuning is a part of Calibration Changing some values to make a vehicle faster, have better accelaration etc. This calibration process is used to fine tune all parameters before final manufacturing process Usually XCP interface is removed from final production If XCP is open, you still need to reverse the firmware to understand the ECU  How to Calibrate and Adjust  Calibration Software Vehicle networks Interface to the ECU Calibration Protocol ECU description file (*.a2l)  How does it work  CCP (CAN Calibration Protocol) XCP (Universal Calibration Protocol)  Tools CANape\n", 
        "url": "http:\/\/127.0.0.1:8800\/notes\/public\/"
    },
    
    
    
    "http:\/\/127.0.0.1:8800\/notes\/public\/categories\/": {
        
        "title": "Categories",
        "tags": [],
        "content": "", 
        "url": "http:\/\/127.0.0.1:8800\/notes\/public\/categories\/"
    },
    
    
    
    "http:\/\/127.0.0.1:8800\/notes\/public\/ecu-compromisation\/": {
        
        "title": "ECU Compromisation",
        "tags": [],
        "content": "Five steps to compromise ECU:\n Remote access Access to in-vehicle network Bridge domain boundaries Access to target ECU Manipulate ECU or vehicle behavior  ", 
        "url": "http:\/\/127.0.0.1:8800\/notes\/public\/ecu-compromisation\/"
    },
    
    
    
    "http:\/\/127.0.0.1:8800\/notes\/public\/ecu-foundations\/": {
        
        "title": "ECU Foundations",
        "tags": [],
        "content": "ECU  Electronic Control Unit the \u0026ldquo;ECU\u0026rdquo; Doing calculations or apply rules in the vehicle system  Calculation example of ECU Meassure \u0026ldquo;Speed (km/h)\u0026rdquo; ECU would \u0026ldquo;calculate\u0026rdquo;: - speed (km/h) = wheel (rpm) x 3.6   Apply a tiny part of logic  If speed is above 5km/h, then lock the doors   ECUs are wired to sensors, mothers, and other actuators One ECU can be used for different vehicles They use microcontroller (have memory/storage unlike microprocessor) Uses embedded software, via special hardware that converts electrical signal to numbers (and vice-versa), collectively IO (input/output) Uses networking hardware, via in-vehicle networks (like CANBus)  ECU Software Layers\n Control functions that ECU runs are referred to as \u0026ldquo;application software\u0026rdquo;, (ie window control, etc.) (ASW) Network connections of IO of ECU are managed via \u0026ldquo;basic software\u0026rdquo; (like an operating system layer) (BSW) Runtime environment \u0026ldquo;RTE\u0026rdquo; glues both Network and Control functions, takes output from ASW to BSW To update ECU software, we can use UDS and Flash Bootloader a special piece of ECU that updates the firmware  Diagnostis  OBD protocol (On Board Diagnostics) Use OBD to diagnose ECU\u0026rsquo;s  HCP (New era of ECU\u0026rsquo;s)  There is new generation of ECU called high-performance computing platform (HCP)  ", 
        "url": "http:\/\/127.0.0.1:8800\/notes\/public\/ecu-foundations\/"
    },
    
    
    
    "http:\/\/127.0.0.1:8800\/notes\/public\/ethernet-specifications\/": {
        
        "title": "Ethernet Specifications",
        "tags": [],
        "content": "Specifications  SomeIP, Ethernet, IP Stack New standard 10BASE-T1S 10Mbit/s Half-duplex PLCA bus cycle - only specific PHY that can send data Physical Layer Collision Avoidance (PLCA) Avoid collision of data Multiple applications on single cable   ", 
        "url": "http:\/\/127.0.0.1:8800\/notes\/public\/ethernet-specifications\/"
    },
    
    
    
    "http:\/\/127.0.0.1:8800\/notes\/public\/networks-in-vehicles\/": {
        
        "title": "Networks in Vehicles",
        "tags": [],
        "content": " Link ECUs to avoid wires (weight, size, cost) Network Protocols allow ECUs to share information quickly and precisely Networks used between ECUs are based on Serial Communications  Serial means that items of information are sent via a single stream of communication   Speed of communication is measured in number of bits sent per second (bps) CAN (Controller Area Network) bus was developed to meet needs of up to 1 million bits per second (1Mbps) LIN (Local Interconnect Network) introduced to give a lower cost, lower speed altenative (~20 kbps) FlexRay was developed for more fault-tolerant, higher speed (10Mbps) network Ethernet (100Mbps) for videos and advanced driver assistance systems (new vehicles)  Special ECU are used called \u0026ldquo;gateways\u0026rdquo; to interconnect different network protocols (CAN + LIN, or Ethernet + FlexRay etc.)\nVehicle Diagnostics  ECUs provide diangostis services OBD standardises requests and responses related to diagnostics ISO 14229-1 (UDS) Standard  Defines structures and content of how data is interpreted   Read Fault Memory in the form of Diagnostic Trouble Codes from the ECU (detect faults)  ", 
        "url": "http:\/\/127.0.0.1:8800\/notes\/public\/networks-in-vehicles\/"
    },
    
    
    
    "http:\/\/127.0.0.1:8800\/notes\/public\/posts\/": {
        
        "title": "Posts",
        "tags": [],
        "content": "", 
        "url": "http:\/\/127.0.0.1:8800\/notes\/public\/posts\/"
    },
    
    
    
    "http:\/\/127.0.0.1:8800\/notes\/public\/security-testing\/": {
        
        "title": "Security Testing",
        "tags": [],
        "content": "Security Testing Methods  Brute-force CAN fuzzer for fuzzing application software Interface scanner, layered fuzzing DoS, Replay Messages, Tampering Man in the Middle Read and write into flash dump (extract keys, certificates, sensitive data)  Security Testing in Practice  Send out particular frame IDs using IG Generator Mount network-based attacks like DoS, MiTM, Tampering of Signals Access to debug ports like JTAG to extract + corrupt flash memory/firmware Flash dump - Look into sensitive data  Approach  Reconnaissance Start with market requirements Use customer-provided documents of the system, brochures, user manuals, published material and attacks and vulnerabilities of used components  Understand the Architecture  Analyze high-level architecture and interfaces to understand interaction between different components Use architecture model, system context, interface model, attack pathway, sequence diagram  Identify valued and protectable assets  Identify relevant assets, such is hardware, software, database, etc. Parse every requirement (requirement description) for a specific asset - Splut it into SFOP scheme (Safety, Finance, Operational Performance, Privacy)  Generate Penetration Test Cases  Do X and Y on CAN Do Z and W on LIN  Perform risk-based greybox PT   Re-create attack scenarios on devices to identify potential vulns\n  Injecting,tampering\n Software checks:  Invalid address Modified SW Odd address Invalid signature Invalid seed-key Downgrade software Secure boot?      Ques?  Can we read the key, flash? Can we modify the flash or CAN messages? Can we perform a DoS and make the service unavailable Whats the goal of the attacker? What can he misuse and abuse  ", 
        "url": "http:\/\/127.0.0.1:8800\/notes\/public\/security-testing\/"
    },
    
    
    
    "http:\/\/127.0.0.1:8800\/notes\/public\/specifications\/": {
        
        "title": "Specifications",
        "tags": [],
        "content": " Extended CAN frame. Can send larger payloads. A bit different structure. Using CANEdge2 for testing the CANFD frames.  ", 
        "url": "http:\/\/127.0.0.1:8800\/notes\/public\/specifications\/"
    },
    
    
    
    "http:\/\/127.0.0.1:8800\/notes\/public\/tags\/": {
        
        "title": "Tags",
        "tags": [],
        "content": "", 
        "url": "http:\/\/127.0.0.1:8800\/notes\/public\/tags\/"
    },
    
    
    
    "http:\/\/127.0.0.1:8800\/notes\/public\/videos\/": {
        
        "title": "Videos",
        "tags": [],
        "content": "https://www.youtube.com/watch?v=xHfInsMEYdQ https://www.youtube.com/watch?v=DUNWZnhneiI https://www.youtube.com/watch?v=mz55tsLnlSc https://www.youtube.com/watch?v=k50hU6aPlG8 https://www.youtube.com/watch?v=k4JD2ZUHrXA - Cert-based auth via UDS https://www.youtube.com/watch?v=KqV5nIkGKFs - CANFD explained https://www.youtube.com/watch?v=XMVLkbw1BNE - New Standard for Ethernet on a Bus Line (10BASE-T1S) https://www.youtube.com/watch?v=WW481idfcro - Cert-based auth via Vector tool https://www.youtube.com/watch?v=pxlx3_gEiFM - Embedded Security in Automotive https://www.youtube.com/watch?v=3uU0Sl-byVc - Using ML to detect anomalyes https://www.youtube.com/watch?v=QEOWjEytb6Y - Cert-based in diagnostics (in-depth) https://www.youtube.com/watch?v=bUdxpsQXeRU - Corporate security testing in Automotive https://www.youtube.com/watch?v=DuXhz4mDYZA - From TARA to Pentest https://www.youtube.com/watch?v=7D7uNqPWrXw - Using Scapy for Car pentesting\nhwio\nhttps://www.youtube.com/watch?v=2fplLJ3S3d0 https://www.youtube.com/watch?v=Myp4-RsdE-Y https://www.youtube.com/watch?v=Hzazchbvu6M https://www.youtube.com/watch?v=dZVWXP2j0co https://www.youtube.com/watch?v=10Dag6ee2d8\nudemy/can interface https://deloittedevelopment.udemy.com/course/master-can-protocol-completely-from-scratch/learn/\n Provided by Aron S.\n check these out to see how the UI looks. They have their own scripting language called CAPL:\nhttps://www.youtube.com/watch?v=uffjocL9Zt8 https://www.youtube.com/watch?v=KbVPeI9A_ME\n", 
        "url": "http:\/\/127.0.0.1:8800\/notes\/public\/videos\/"
    },
    
}
</script>


<script src="http://127.0.0.1:8800/notes/public/js/lunr.min.js" type="text/javascript"></script>


<script src="http://127.0.0.1:8800/notes/public/js/search.js" type="text/javascript"></script>
</body>
</html>
