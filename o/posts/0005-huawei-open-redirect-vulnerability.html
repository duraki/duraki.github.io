<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
        <title>Bugbounty/ Huawei Open-redirect vuln @ Uniportal</title>

        <meta name="theme-color" content="#252525">

	<link href="https://fonts.googleapis.com/css?family=Amiri" rel="stylesheet" type="text/css">
	<link href="https://fonts.googleapis.com/css?family=Raleway:100" rel="stylesheet" type="text/css">
	<link href="https://fonts.googleapis.com/css?family=Roboto+Mono:100,300,400" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700|Open+Sans:300,400,600|Raleway:200,300,400,600&amp;subset=latin-ext" rel="stylesheet">

        <link rel="stylesheet" href="assets/css/normalize.css">
        <link rel="stylesheet" href="assets/css/skeleton.css">
        <link rel="stylesheet" href="assets/css/home.css">

    </head>
    <body>

        <div class="container" style="margin-top: 30px;">

            <div class="row">
                <p style="text-align:center;">
                    <img src="assets/img/duraki-logo.png" alt="duraki logo"/>
                </p>
            </div>

	    <div class="row">
                <div class="one-sixth column" style="margin-top: 10%; margin-left: 0%";>
                    <h3><a href="/">blog</a> / <a href="">Bugbounty/ Huawei Open-redirect vuln @ Uniportal</a></h3>
                </div>
	    </div>

            <div class="tags">
            <code class="tags-code">huawei</code>
            <code class="tags-code">support</code>
            <code class="tags-code">webapp</code>
            <code class="tags-code">openredirect</code>
            <code class="tags-code">vuln</code>
            <code class="tags-code">bugbounty</code>
            </div>

	    <hr style="display: block; text-align: left; width: 100%;" />

            <div class="row">
                <div class="six columns" style="margin-top: 0%;"><h2 id="vulnerability-no.-#1"><a class="header-link" href="#vulnerability-no.-#1"></a>Vulnerability No. #1</h2>
<p>Huawei uniportal located under sub-domain <a href="http://uniportal.huawei.com/uniportal/">http://uniportal.huawei.com/uniportal/</a> have open-redirect vulnerability in which application takes a parameter and redirects a user to the parameter value without any validation. This vulnerability can lead to medium-to-high risk phishing attacks. This vulnerability can lead to other bugs too. Vulnerability is reported to Huawei and is properly fixed. </p>
<h2 id="poc"><a class="header-link" href="#poc"></a>PoC</h2>
<p>To recreate this vulnerability login with your username &amp; password @ huawei official login. Make sure to &quot;Remember password&quot;, otherwise exploit is not always successful because of Huawei session. Now, everytime you visit this link[1] you will be redirected to <code>http://example.com</code>.You can change redirect parameter to coresponding website you want to redirect to. This vulnerability works out-of-box on whole /www/ scope. Be sure to check video at the end of proper PoC. </p>
<pre class="hljs"><code>[<span class="hljs-number">1</span>] https:<span class="hljs-regexp">//u</span>niportal.huawei.com<span class="hljs-regexp">/uniportal/</span>?redirect=http:<span class="hljs-regexp">//</span>www.example.com<span class="hljs-regexp">/</span></code></pre><h2 id="fix"><a class="header-link" href="#fix"></a>Fix</h2>
<p>Check if parameter redirect have value of unknown host and make sure to properly sanitize input of the parameter. </p>
<h2 id="video"><a class="header-link" href="#video"></a>Video</h2>
<iframe src="https://player.vimeo.com/video/93200621" width="500" height="400" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
                </div>
            </div>

	    <hr style="display: block; text-align: left; width: 100%;" />

	    <small style="color:rgba(68, 63, 63, 0.42)">this project, script or post is written by @durakih (c) 2017</small>

        </div>
    </body>
</html>
